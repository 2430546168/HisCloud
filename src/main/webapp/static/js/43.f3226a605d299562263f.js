webpackJsonp([43],{fWXY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("//Fk"),a=i.n(s),n=i("+n8h"),o=i("HywI"),c=i("T4ej"),l=i("uGJ5"),r=new Date;r.getFullYear();if(r.getMonth()+1<10)r.getMonth();else r.getMonth();if(r.getDate()<10)r.getDate();else r.getDate();var v={components:{tabbar:n.a,pullRefresh:o.a,loading:c.a},data:function(){return{ecipeList:[],drugList:[],value3:"0",cardno:[],model1:"",cityList:[],cardlist:[],modal11:!1,value1:"",isshowloading:!1,model2:"",mod1:!1,mod2:!1,mod3:!1,assaysList:[],examList:[],drug:[],size:10,num:0}},methods:{formatDate:function(t){var e=t.getFullYear();if(t.getMonth()+1<10)var i="0"+(t.getMonth()+1);else i=t.getMonth()+1;if(t.getDate()<10)var s="0"+t.getDate();else s=t.getDate();t.getHours(),t.getMinutes(),t.getSeconds();return e+"-"+i+"-"+s},checkMoney:function(t){for(var e=0,i=this.ecipeList[t].check,s=0;s<i.length;s++)e+=parseFloat(i[s].charges);return e.toFixed(2)},modal2:function(t){this.mod2=!0,this.examList=this.ecipeList[t].check},datatime:function(t){var e=t,i=this.p(e.getFullYear()),s=this.p(e.getMonth()+1);this.p(e.getDate());return i+"-"+s},p:function(t){return t<10?"0"+t:t},refresh:function(){var t=this;return new a.a(function(e,i){setTimeout(function(){t.GetRecipeList(),e()},2e3)})},tobackdetail:function(){this.$router.push("/Myaccount")},selectcard:function(t){this.examtList(t)},qingkong:function(){""!=this.value1&&null!=this.value1&&(this.value1="",this.examtList())},shaixuan:function(){null==this.value1?(this.value1="",this.size=10):this.value1=this.datatime(this.value1),this.examtList()},examtList:function(){var t=this,e=t.$store.getters.getUrl+"prescription/getCheckOrChemical.do",i=localStorage.getItem("cardno"),s=t.value1,a=t.size;t.isshowloading=!0;var n=$.ajax({url:e,type:"post",dataType:"json",timeout:15e3,data:{cardno:i,billdate:s,itemtype:"D",type:"month",doccode:"",size:a},success:function(e){t.ecipeList=[],t.isshowloading=!1;for(var i=0;i<e.data.length;i++)t.ecipeList.push(e.data[i]);for(var s=t.ecipeList,a=[],n=0;n<s.length;n++)a.push(s[n].visitno);for(var o=[],c=0;c<a.length;c++)if(0==o.length)o.push(a[0]);else{var l=a[c];-1==o.indexOf(l)&&o.push(l)}for(var r=[],v=0;v<o.length;v++)r.push({visitno:o[v],subarr:[]});for(var p=0;p<s.length;p++){r[o.indexOf(s[p].visitno)].subarr.push(s[p])}for(var u=0;u<r.length;u++)r[u].check=[];for(var d=0;d<r.length;d++)for(var h=0;h<r[d].subarr.length;h++)"D"==r[d].subarr[h].itemclass&&r[d].check.push(r[d].subarr[h]);r.length<7&&t.num!==r.length&&(t.num=r.length,t.size+=15,t.examtList()),r.length>=7?(r.splice(r.length-1,1),t.ecipeList=r):t.ecipeList=r},error:function(e){t.isshowloading=!1},complete:function(e,i){"timeout"==i&&(n.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})}},mounted:function(){var t=this;t.isshowloading=!0;var e=document.querySelector(".MyExamine"),i=e.offsetHeight;setInterval(function(){e.onscroll=function(){var s=e.scrollTop,a=e.scrollHeight;i+s-a>=-1&&(t.size+=5,t.examtList())}},1e3),t.examtList();var s=t.$store.getters.getUrl+"SweepCode.do";Object(l.a)(s)}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"MyExamine"},[i("div",{staticClass:"titlei"},[i("div",{staticClass:"title"},[i("div",{staticClass:"arrow-icon",on:{click:t.tobackdetail}},[i("Icon",{attrs:{size:"30",type:"ios-arrow-back"}})],1),t._v("\n          检查处方\n    ")]),t._v(" "),i("div",{staticClass:"xuanze",staticStyle:{position:"relative"}},[i("div",{staticStyle:{display:"inline-block",width:"100%"}},[i("span",{staticStyle:{color:"rgb(40, 184, 161)","font-size":"20px"},on:{click:t.qingkong}},[t._v("全部检查")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"30%",border:"0",position:"absolute",right:"5%",top:"7px"},attrs:{type:"month",placeholder:"选择月份",editable:!1,clearable:!0,size:"small"},on:{change:t.shaixuan},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1)])]),t._v(" "),i("div",{staticClass:"content"},[0==t.ecipeList.length?i("div",{staticClass:"ecipeList",staticStyle:{"text-align":"center","font-size":"18px",padding:"20% 0"}},[t._v(" \n          暂无数据\n        ")]):t._e(),t._v(" "),0!==t.ecipeList.length?i("div",{staticClass:"ecipeList",staticStyle:{padding:"10px"}},[t._l(t.ecipeList,function(e,s){return i("div",{key:s,staticClass:"xiang"},[0!=e.check.length?i("div",{staticClass:"examList"},[i("div",{staticStyle:{"border-bottom":"1px solid #ccc"}},[t._m(0,!0),t._v(" "),i("p",[i("span",[t._v("就诊序号：")]),i("span",[t._v(t._s(e.check[0].visitno))])]),t._v(" "),i("p",[i("span",[t._v("生成时间：")]),i("span",[t._v(t._s(t.formatDate(new Date(e.check[0].visitdate))))])]),t._v(" "),i("p",[i("span",[t._v("项目详情：")]),i("span",{staticStyle:{color:"blue"},on:{click:function(e){return t.modal2(s)}}},[t._v("查看>")])]),t._v(" "),i("p",[i("span",[t._v("合计金额：")]),i("span",{staticStyle:{color:"red","font-size":"18px"}},[t._v("￥"+t._s(t.checkMoney(s)))])])]),t._v(" "),i("Modal",{attrs:{fullscreen:"",title:"项目详情"},model:{value:t.mod2,callback:function(e){t.mod2=e},expression:"mod2"}},t._l(t.examList,function(e,s){return i("div",{key:s,staticClass:"ecipeList",staticStyle:{"font-size":"16px","border-bottom":"1px solid #ccc",padding:"10px 0","font-weight":"650"}},[i("div",{staticStyle:{"text-align":"center","font-size":"18px",padding:"10px 0"}},[t._v(t._s(e.itemname))]),t._v(" "),i("p",[i("span",[t._v("编码：")]),i("span",[t._v(t._s(e.itemcode))])]),t._v(" "),i("p",[i("span",[t._v("数量：")]),i("span",[t._v(t._s(e.amount))])]),t._v(" "),i("p",[i("span",[t._v("单价：")]),i("span",{staticStyle:{color:"red","font-size":"18px"}},[t._v("￥"+t._s(e.charges))])]),t._v(" "),i("p",[i("span",[t._v("规格：")]),i("span",[t._v(t._s(e.itemspec))])]),t._v(" "),i("p",[i("span",[t._v("单位：")]),i("span",[t._v(t._s(e.units))])])])}),0)],1):t._e()])}),t._v(" "),0==t.ecipeList[0].check.length?i("div",{},[i("p",{staticStyle:{"font-size":"18px",margin:"20% 0","text-align":"center"}},[t._v("暂无数据")])]):t._e()],2):t._e()]),t._v(" "),i("tabbar",{staticClass:"tabbar"}),t._v(" "),i("loading",{directives:[{name:"show",rawName:"v-show",value:t.isshowloading,expression:"isshowloading"}],staticClass:"loading"})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("span",[this._v("处方类型：")]),e("span",[this._v("检查处方")])])}]};var u=i("VU/8")(v,p,!1,function(t){i("nJ77")},"data-v-5fcef8dd",null);e.default=u.exports},nJ77:function(t,e){}});