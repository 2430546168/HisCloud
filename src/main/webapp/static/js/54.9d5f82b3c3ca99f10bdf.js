webpackJsonp([54],{Ub3s:function(t,e){},Z5Cg:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("//Fk"),a=s.n(i),n=s("+n8h"),o=s("HywI"),l=s("T4ej"),r=s("uGJ5"),c=new Date;c.getFullYear();if(c.getMonth()+1<10)c.getMonth();else c.getMonth();if(c.getDate()<10)c.getDate();else c.getDate();var p={components:{tabbar:n.a,pullRefresh:o.a,loading:l.a},data:function(){return{ecipeList:[],drugList:[],value3:"0",cardno:[],model1:"",cityList:[],cardlist:[],modal11:!1,value1:"",isshowloading:!1,model2:"",mod1:!1,mod2:!1,mod3:!1,assaysList:[],examList:[],drug:[],size:15,num:0}},methods:{formatDate:function(t){var e=t.getFullYear();if(t.getMonth()+1<10)var s="0"+(t.getMonth()+1);else s=t.getMonth()+1;if(t.getDate()<10)var i="0"+t.getDate();else i=t.getDate();t.getHours(),t.getMinutes(),t.getSeconds();return e+"-"+s+"-"+i},totalMoney:function(t){for(var e=0,s=this.ecipeList[t].drug,i=0;i<s.length;i++)e+=parseFloat(s[i].costs.toFixed(2));return e.toFixed(2)},modal:function(t){this.mod1=!0,this.drug=this.ecipeList[t].drug},datatime:function(t){var e=t,s=this.p(e.getFullYear()),i=this.p(e.getMonth()+1);this.p(e.getDate());return s+"-"+i},p:function(t){return t<10?"0"+t:t},refresh:function(){var t=this;return new a.a(function(e,s){setTimeout(function(){t.GetRecipeList(),e()},2e3)})},tobackdetail:function(){this.$router.push("/Myaccount")},qingkong:function(){""!=this.value1&&null!=this.value1&&(this.value1="",this.GetRecipeList())},shaixuan:function(){null==this.value1?(this.value1="",this.size=10):this.value1=this.datatime(this.value1),this.GetRecipeList()},GetRecipeList:function(){var t=this;t.modal11=!0,t.isshowloading=!0;var e=t.$store.getters.getUrl+"prescription/GetRecipeList.do",s=localStorage.getItem("cardno"),i=(localStorage.getItem("RecipeID"),t.value1),a=t.size,n=$.ajax({url:e,type:"post",dataType:"json",timeout:15e3,data:{cardno:s,visitdate:i,type:"month",doccode:"",size:a},success:function(e){t.isshowloading=!1,t.ecipeList=[];for(var s=0;s<e.data.length;s++)t.ecipeList.push(e.data[s]);for(var i=t.ecipeList,a=[],n=0;n<i.length;n++)a.push(i[n].visitno);for(var o=[],l=0;l<a.length;l++)if(0==o.length)o.push(a[0]);else{var r=a[l];-1==o.indexOf(r)&&o.push(r)}for(var c=[],p=0;p<o.length;p++)c.push({visitno:o[p],subarr:[]});for(var u=0;u<i.length;u++){c[o.indexOf(i[u].visitno)].subarr.push(i[u])}for(var d=0;d<c.length;d++)c[d].drug=[];for(var v=0;v<c.length;v++)for(var g=0;g<c[v].subarr.length;g++)"A"!=c[v].subarr[g].itemclass&&"B"!=c[v].subarr[g].itemclass||c[v].drug.push(c[v].subarr[g]);c.length<7&&t.num!==c.length&&(t.num=c.length,t.size+=15,t.GetRecipeList()),c.length>=7?(c.splice(c.length-1,1),t.ecipeList=c):t.ecipeList=c},error:function(e){t.isshowloading=!1,t.$Message.error("请求失败")},complete:function(e,s){"timeout"==s&&(n.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})}},mounted:function(){var t=this;t.isshowloading=!0;var e=document.querySelector(".MyExamine"),s=e.offsetHeight;setInterval(function(){e.onscroll=function(){var i=e.scrollTop,a=e.scrollHeight;s+i-a>=-1&&(t.size+=5,t.GetRecipeList())}},1e3),t.GetRecipeList();var i=t.$store.getters.getUrl+"SweepCode.do";Object(r.a)(i)}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MyExamine"},[s("div",{staticClass:"titlei"},[s("div",{staticClass:"title"},[s("div",{staticClass:"arrow-icon",on:{click:t.tobackdetail}},[s("Icon",{attrs:{size:"30",type:"ios-arrow-back"}})],1),t._v("\n        药品处方\n    ")]),t._v(" "),s("div",{staticClass:"xuanze",staticStyle:{position:"relative"}},[s("div",{staticStyle:{display:"inline-block",width:"100%"}},[s("span",{staticStyle:{color:"rgb(40, 184, 161)","font-size":"20px"},on:{click:t.qingkong}},[t._v("全部药品")]),t._v(" "),s("el-date-picker",{staticStyle:{width:"30%",border:"0",position:"absolute",right:"5%",top:"7px"},attrs:{type:"month",placeholder:"选择月份",editable:!1,clearable:!0,size:"small"},on:{change:t.shaixuan},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1)])]),t._v(" "),s("div",{staticClass:"contenttt"},[0==t.ecipeList.length?s("div",{staticClass:"ecipeList",staticStyle:{"text-align":"center","font-size":"18px",padding:"20% 0"}},[t._v(" \n             暂无数据\n        ")]):t._e(),t._v(" "),0!==t.ecipeList.length?s("div",{staticClass:"ecipeList"},[t._l(t.ecipeList,function(e,i){return s("div",{key:i,staticClass:"xiang"},[0!=e.drug.length?s("div",{staticClass:"chufang",staticStyle:{"border-bottom":"1px solid #ccc",padding:"10px"}},[t._m(0,!0),t._v(" "),s("p",[s("span",[t._v("就诊序号：")]),s("span",[t._v(t._s(e.drug[0].visitno))])]),t._v(" "),s("p",[s("span",[t._v("生成时间：")]),s("span",[t._v(t._s(t.formatDate(new Date(e.drug[0].visitdate))))])]),t._v(" "),s("p",[s("span",[t._v("项目详情：")]),s("span",{staticStyle:{color:"blue"},on:{click:function(e){return t.modal(i)}}},[t._v("查看>")])]),t._v(" "),s("p",[s("span",[t._v("合计金额：")]),s("span",{staticStyle:{color:"red","font-size":"18px"}},[t._v("￥"+t._s(t.totalMoney(i)))])]),t._v(" "),s("Modal",{attrs:{fullscreen:"",title:"项目详情"},model:{value:t.mod1,callback:function(e){t.mod1=e},expression:"mod1"}},t._l(t.drug,function(e,i){return s("div",{key:i,staticClass:"ecipeListmodal",staticStyle:{"font-size":"16px","border-bottom":"1px solid #ccc",padding:"10px 0","font-weight":"650"}},[s("div",{staticStyle:{"text-align":"center","font-size":"18px",padding:"10px 0"}},[t._v(t._s(e.drugname))]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("编码：")]),s("span",[t._v(t._s(e.drugcode))])]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("数量：")]),s("span",[t._v(t._s(e.amount))])]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("规格：")]),s("span",[t._v(t._s(e.drugspec))])]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("单位：")]),s("span",[t._v(t._s(e.units))])]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("用法：")]),s("span",[t._v(t._s(e.administration))])]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("频次：")]),s("span",[t._v(t._s(e.frequency))])]),t._v(" "),s("p",[s("span",{staticClass:"titletip"},[t._v("价格：")]),s("span",{staticStyle:{color:"red","font-size":"18px"}},[t._v("￥"+t._s(e.costs.toFixed(2)))])])])}),0)],1):t._e()])}),t._v(" "),0==t.ecipeList[0].drug.length?s("div",{staticClass:"chufang"},[s("p",{staticStyle:{"font-size":"18px",padding:"20% 0","text-align":"center"}},[t._v("暂无数据")])]):t._e()],2):t._e()]),t._v(" "),s("tabbar",{staticClass:"tabbar"}),t._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:t.isshowloading,expression:"isshowloading"}],staticClass:"loading"})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("span",[this._v("处方类型：")]),e("span",[this._v("药品处方")])])}]};var d=s("VU/8")(p,u,!1,function(t){s("Ub3s")},"data-v-4e819f5a",null);e.default=d.exports}});