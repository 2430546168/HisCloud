webpackJsonp([3,4,26,34,67,75],{"+JLr":function(e,t){},"/cOS":function(e,t){function s(){var e={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return e}var i=/javascript\s*\:/gim;t.whiteList=s(),t.getDefaultWhiteList=s,t.onAttr=function(e,t,s){},t.onIgnoreAttr=function(e,t,s){},t.safeAttrValue=function(e,t){return i.test(t)?"":t}},"0Zbq":function(e,t,s){var i=s("/cOS"),n=s("huvo");for(var a in(t=e.exports=function(e,t){return new n(t).process(e)}).FilterCSS=n,i)t[a]=i[a];"undefined"!=typeof window&&(window.filterCSS=e.exports)},"0hsi":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("pFYg"),n=s.n(i),a=s("Xxa5"),r=s.n(a),o=s("exGp"),c=s.n(o),l=s("//Fk"),u=s.n(l),d=s("mvHQ"),m=s.n(d),p=s("woOf"),f=s.n(p),v={components:{loading:s("T4ej").a},data:function(){return{requestmodel:!1,infomsg:"",isfetchdrugs:!1,isinsertprescribe:!1,opacity:1,isshowtip:!1,deldrugindex:!1,isshowall:!1,currentdrugindex:-1,isshowdrugs:!1,isshowloading:!1,modal11:!1,searchdrugs:[],searchdrugses:[],drugNamees:"",defaultchannel:"",channel:[],frequency:[],modal1:!1,drugName:"",searchdruglist:[],east:{administretion:"水煎服",frequency:"",freq:"",repetition:"",abidance:""},form:{visitno:"",clinicno:"",name:"",cardno:"",orderby:"",depname:"",docname:"",doccode:"",openid:"",starttime:"",nizhen:"",itemclass:"B",orderclass:"B",sumcharges:"",outs:[]},procjectid:"",doctorno:""}},mounted:function(){var e=this;e.isshowloading=!0,setTimeout(function(){e.initdata(),e.getcurrentdayrecord(),e.init()},10)},methods:{initdata:function(){this.isfetchdrugs=!1,this.isinsertprescribe=!1,this.opacity=1,this.isshowtip=!1,this.deldrugindex=!1,this.isshowall=!1,this.currentdrugindex=-1,this.isshowdrugs=!1,this.isshowloading=!1,this.searchdrugs=[],this.searchdrugses=[],this.defaultchannel="",this.channel=[],this.frequency=[],this.modal1=!1,this.drugName="",this.searchdruglist=[],this.east.administretion="水煎服",this.east.frequency="",this.east.freq="",this.east.repetition="",this.east.abidance="",this.form.visitno="",this.form.clinicno="",this.form.name="",this.form.cardno="",this.form.orderby="",this.form.depname="",this.form.docname="",this.form.doccode="",this.form.openid="",this.form.starttime="",this.form.nizhen="",this.form.itemclass="B",this.form.orderclass="B",this.form.sumcharges="",this.form.outs=[]},inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},getcurrentdayrecord:function(){var e=this,t=JSON.parse(localStorage.getItem("yspatientinfo")),s=t.patientid,i=t.visitno,n=new Date,a=n.getFullYear(),r=n.getMonth()+1,o=n.getDate();r<10&&(r="0"+r),o<10&&(o="0"+o);var c=a+"-"+r+"-"+o,l=t.doctor,u=e.$store.getters.getUrl+"medicalrecord/getthesamedayoutpmr.do",d=$.ajax({url:u,type:"post",dataType:"json",timeout:15e3,async:!0,data:{patientid:s,visitdate:c,doccode:l,visitno:i},success:function(t){e.isshowloading=!1,1==t.status?e.form.nizhen=t.data[0].diagdesc:-1==t.status?e.$router.push("/abnormal"):(e.requestmodel=!0,e.infomsg="获取数据失败")},error:function(t){e.isshowloading=!1,e.requestmodel=!0,e.infomsg="请求发送失败"},complete:function(t,s){"timeout"==s&&(d.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},toinsertprescribe:function(){this.isinsertprescribe=!0},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},deletoutsitem:function(){this.form.outs.splice(this.deldrugindex,1);for(var e=this.form.outs,t=0,s=0;s<e.length;s++)t+=e[s].charges;t=parseInt(100*t)/100,this.form.sumcharges=t},isdeletitem:function(e){this.deldrugindex=e,this.isshowtip=!0},editdrugdetail:function(e){"-1"==e?this.isshowall=!0:(this.isshowall=!1,this.currentdrugindex=e),this.isshowdrugs=!0},topath:function(){},sumprice:function(){var e=void 0;"一日一次"==this.east.frequency?e=1:"一日二次"==this.east.frequency?e=2:"一日三次"==this.east.frequency?e=3:"一日四次"==this.east.frequency?e=4:"一日五次"==this.east.frequency?e=5:"一日六次"==this.east.frequency&&(e=6);var t=void 0;"一日一次"==this.east.freq?t=1:"一日二次"==this.east.freq?t=2:"一日三次"==this.east.freq?t=3:"一日四次"==this.east.freq?t=4:"一日五次"==this.east.freq?t=5:"一日六次"==this.east.freq&&(t=6);for(var s=0;s<this.form.outs.length;s++){var i=this.form.outs[s].price.toString().split("."),n=i[1].length,a=0;if(0==i[0]){var r=this.form.outs[s].price*Math.pow(10,n);a=parseInt(r)}else a=this.form.outs[s].price*Math.pow(10,n);this.form.outs[s].charges=parseInt(this.east.repetition)*parseInt(this.form.outs[s].dosAge)*a/Math.pow(10,n),this.form.outs[s].costs=parseInt(this.east.repetition)*parseInt(this.form.outs[s].dosAge)*a/Math.pow(10,n),this.form.outs[s].amount=parseInt(this.form.outs[s].dosAge)*parseInt(this.east.repetition);var o;o=Math.ceil(this.east.repetition*t/e),this.east.abidance=o,f()(this.form.outs[s],this.east)}for(var c=this.form.outs,l=0,u=0;u<c.length;u++)l+=c[u].charges;l=parseInt(100*l)/100,this.form.sumcharges=l},checkouts:function(e){for(var t=!1,s=0;s<e.length;s++)for(var i in e[s]){if(""===e[s][i])return this.styleindex=s,this.$Message.warning("请把信息填写完整！"),t=!1,!1;t=!0}return t},insertprescribe:function(){var e=this;if(this.sumprice(),e.checkouts(e.form.outs)){var t=m()(e.form.outs),s={};s.outs=t,s.name=e.form.name,s.cardno=e.form.cardno,s.clinicno=e.form.clinicno,s.visitno=e.form.visitno,s.orderby=e.form.orderby,s.docname=e.form.docname,s.doccode=e.form.doccode,s.sumcharges=e.form.sumcharges,s.itemclass=e.form.itemclass,s.orderclass=e.form.orderclass,s.depname=e.form.depname,s.nizhen=e.form.nizhen;var i=e.$store.getters.getUrl+"prescription/prescribe.do?openid="+e.form.openid+"&starttime="+e.form.starttime;e.isshowloading=!0;var n=$.ajax({url:i,type:"post",dataType:"json",timeout:15e3,async:!0,contentType:"application/json",data:m()(s),success:function(t){e.isshowloading=!1,"1"===t.status?(e.$Message.info("开方成功"),e.initdata(),e.getcurrentdayrecord(),e.init(),window.websocketobj.send(m()({cardno:e.form.cardno,massege:"123"}))):(e.isshowloading=!1,e.requestmodel=!0,e.infomsg="开方失败")},error:function(t){e.isshowloading=!1,e.requestmodel=!0,e.infomsg="请求发送失败"},complete:function(t,s){"timeout"==s&&(n.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})}},getfirmid:function(e){var t=this,s=e.drugspec,i=e.ypcode,n=t.$store.getters.getUrl+"prescription/specification.do";return t.isshowloading=!0,new u.a(function(e,a){$.ajax({url:n,type:"post",dataType:"json",async:!1,data:{itemcode:i,itemspec:s},success:function(s){t.isshowloading=!1,e(s)},error:function(s){t.isshowloading=!1,e({status:5})}})})},adddrug1:function(e){var t=this;return c()(r.a.mark(function s(){var i,n;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return(i={drugCode:"",drugName:"",drugSpec:"",firmId:"",units:"",dispensary:"",dispensarySub:"",price:"",dosAgeUnits:"",dosAge:null,administretion:"",frequency:"",repetition:1,amount:"",abidance:"",charges:"",costs:"",orderNo:"1",subOrderNo:"1",freqDetail:"医嘱说明",freq:""}).drugCode=e.ypcode,i.drugName=e.ypname,i.drugSpec=e.drugspec,i.units=e.unit,i.dispensary=e.storagecode,i.dispensarySub=e.substorage,0===e.ypprice.toString().indexOf(".")?i.price="0"+e.ypprice:i.price=e.ypprice,s.next=10,t.getfirmid(e);case 10:"1"==(n=s.sent).status?(i.firmId=n.data[0].firm_id,i.drugSpec=n.data[0].drug_spec+n.data[0].drug_supplier_id):"0"==n.status?(_this.requestmodel=!0,_this.infomsg="暂无数据"):"-1"==fetchfirmiddata.status?(_this.requestmodel=!0,_this.infomsg="系统异常查询药库失败"):(_this.requestmodel=!0,_this.infomsg="请求发送失败");case 12:case"end":return s.stop()}},s,t)}))()},adddrug:function(e){for(var t=this,s=this,i=!0,n=0;n<this.form.outs.length;n++)this.form.outs[n].drugName==e.ypname&&(i=!1);if(i){var a={drugCode:"",drugName:"",drugSpec:"",firmId:"",units:"",dispensary:"",dispensarySub:"",price:"",amount:"",abidance:"",dosAge:null,dosAgeUnits:"",administretion:"",frequency:"",charges:0,costs:0,orderNo:"1",subOrderNo:"1",freqDetail:"医嘱说明",repetition:1,freq:""};a.drugCode=e.ypcode,a.drugName=e.ypname,a.drugSpec=e.drugspec,a.units=e.unit,a.dispensary=e.storagecode,a.dispensarySub=e.substorage,0===e.ypprice.toString().indexOf(".")?a.price="0"+e.ypprice:a.price=e.ypprice,a.dosAgeUnits="g";var r=e.drugspec,o=e.ypcode,c=s.$store.getters.getUrl+"prescription/specification.do";s.isshowloading=!0,$.ajax({url:c,type:"post",dataType:"json",async:!1,data:{itemcode:o,itemspec:r},success:function(e){s.isshowloading=!1,"0"==e.status?(s.requestmodel=!0,s.infomsg="暂无数据"):"1"==e.status?(a.firmId=e.data[0].firm_id,a.drugSpec=e.data[0].drug_spec+e.data[0].drug_supplier_id):(s.requestmodel=!0,s.infomsg="系统异常")},error:function(e){s.isshowloading=!1,s.requestmodel=!0,s.infomsg="请求发送失败"}}),this.form.outs.push(a);var l=this.form.outs;this.form.outs=[],setTimeout(function(){1===l.length?t.currentindex="0":t.currentindex=l.length-1+"",t.form.outs=l,t.isshowdrugs=!0,t.isshowall=!1,t.currentdrugindex=l.length-1,t.modal1=!1},100)}else if(!this.timestate){this.timestate=!0,this.$Message.warning({content:"该药品已选择，请选择其他药品！",duration:1});var u=setInterval(function(){s.timestate=!1,clearInterval(u)},1100)}},showdrugmodal:function(){this.modal1=!0,this.isfetchdrugs||(this.isshowloading=!0)},init:function(){var e=this;return c()(r.a.mark(function t(){var s,i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.getpatientinfo(),t.next=3,e.searchDrug();case 3:if("object"==(void 0===(s=t.sent)?"undefined":n()(s))){t.next=6;break}return t.abrupt("return");case 6:return e.searchdrugs=s,t.next=9,e.fetchchannel();case 9:return i=t.sent,e.dealfetchchannel(i),t.next=13,e.fetchfrequency();case 13:a=t.sent,e.dealfetchfrequency(a);case 15:case"end":return t.stop()}},t,e)}))()},dealfetchfrequency:function(e){this.frequency=[{value:"一日一次",label:"一日一次"},{value:"一日二次",label:"一日二次"},{value:"一日三次",label:"一日三次"},{value:"一日四次",label:"一日四次"},{value:"一日五次",label:"一日五次"},{value:"一日六次",label:"一日六次"}]},fetchfrequency:function(){var e=this,t=e.$store.getters.getUrl+"prescription/frequency.do";return new u.a(function(s,i){var n=$.ajax({url:t,type:"post",dataType:"json",timeout:15e3,async:!0,data:"",success:function(e){s(e.data)},error:function(e){i(e)},complete:function(t,s){"timeout"==s&&(n.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},dealfetchchannel:function(e){this.channel=[];for(var t=0;t<e.length;t++)this.channel.push({value:e[t].pcusename,label:e[t].pcusename})},fetchchannel:function(){var e=this,t=e.$store.getters.getUrl+"prescription/channel.do";return new u.a(function(s,i){var n=$.ajax({url:t,type:"post",dataType:"json",timeout:15e3,async:!0,data:"",success:function(e){s(e.data)},error:function(e){i(e)},complete:function(t,s){"timeout"==s&&(n.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},dealsearchDrug:function(){var e=this.drugName.toUpperCase(),t=this.searchdrugs;if(this.searchdruglist=[],""!==this.drugName)for(var s=0;s<t.length;s++)if(t[s].hasOwnProperty("ypname")&&"0"!=t[s].inventory){var i=t[s].ypname.toString(),n=t[s].inputcode.toString();(i.includes(e)||n.includes(e))&&this.searchdruglist.push(t[s])}},searchDrug:function(){var e=this,t=e.$store.getters.getUrl+"prescription/chinesemedicine.do",s=void 0;return new u.a(function(i,n){$.ajax({url:t,type:"post",dataType:"json",async:!1,data:"",success:function(t){if(e.isshowloading=!1,e.isfetchdrugs=!0,"1"==t.status){for(var i=[],n=0;n<t.data.length;n++)"0"!==t.data[n].inventory&&i.push(t.data[n]);s=i}else"0"==t.status?(e.requestmodel=!0,e.infomsg="暂无数据",s=1):(e.requestmodel=!0,e.infomsg="系统异常",s=1)},error:function(t){e.isshowloading=!1,e.requestmodel=!0,e.infomsg="系统异常",s=1}}),i(s)})},demo:function(){$(".box").css("display","block")},dealsearchDrugses:function(e){this.drugNamees=e.title,this.procjectid=e.treat_project_id,this.doctorno=e.creator;this.east.administretion=e.pcusename,this.east.frequency=e.pccname;var t=this,s=e.treat_project_id,i=e.creator,n=t.$store.getters.getUrl+"prescription/getChineseMedicine.do",a=t.searchdrugs,r=e.pccname;t.infomsg;var o=$.ajax({url:n,type:"post",dataType:"json",timeout:15e3,async:!0,data:{procjectid:s,doctorno:i},success:function(e){for(var s=[],i=0;i<e.data.length;i++)for(var n=0;n<a.length;n++)if(e.data[i].cdrug_code==a[n].ypcode){var o=a[n];o.dosAge=e.data[i].dosage,o.frequency=r,o.firmId=e.data[i].firm_id,s.push(o)}for(i=0;i<s.length;i++)for(var c=i+1;c<s.length;)s[i].ypcode==s[c].ypcode?s.splice(c,1):c++;for(var l=0;l<s.length;l++)t.adddruges(s[l])},error:function(e){},complete:function(e,s){"timeout"==s&&(o.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}});this.modal11=!1},adddruges:function(e){for(var t=this,s=!0,i=0;i<this.form.outs.length;i++)this.form.outs[i].drugName==e.ypname&&(s=!1);if(s)if("A"==this.form.orderclass&&this.form.outs.length>=5)this.$Message.info("西药只能开五种药品！");else{var n={drugCode:"",drugName:"",drugSpec:"",firmId:"",units:"",dispensary:"",dispensarySub:"",price:"",amount:"",abidance:"",dosAge:null,dosAgeUnits:"",administretion:"",frequency:"",charges:0,costs:0,orderNo:"1",subOrderNo:"1",freqDetail:"医嘱说明",repetition:1,freq:""};n.drugCode=e.ypcode,n.drugName=e.ypname,n.drugSpec=e.drugspec,n.units=e.unit,n.dosAge=e.dosAge,n.dispensary=e.storagecode,n.dispensarySub=e.substorage,n.frequency=e.frequency,n.firmId=e.firmId,0===e.ypprice.toString().indexOf(".")?n.price="0"+e.ypprice:n.price=e.ypprice;var a=void 0,r=void 0;if("盒"==e.unit){if(-1!=e.drugspec.indexOf("*")){var o=[];o=e.drugspec.split("*");for(var c=0;c<o.length;c++)-1!=o[c].indexOf(e.spec)&&(r=o[c].split(e.spec)[0],n.dedosAgeUnits=r,n.dosAgeUnits=o[c].split(e.spec)[0]+e.spec);a=parseInt(o[1]),n.yppaccount=a}}else if(n.yppaccount=1,-1!=e.drugspec.indexOf("*")){for(var l=e.drugspec.split("*"),u=0;u<l.length;u++)if(-1!=l[u].indexOf(e.spec))if(-1!=l[u].indexOf(":"))for(var d=l[u].split(":"),m=0;m<d.length;m++)-1!=d[m].indexOf(e.spec)&&(n.dedosAgeUnits=d[m].split(e.spec)[0],n.dosAgeUnits=d[m].split(e.spec)[0]+e.spec);else n.dedosAgeUnits=l[u].split(e.spec)[0],n.dosAgeUnits=l[u].split(e.spec)[0]+e.spec}else if(-1!=e.drugspec.indexOf(":"))for(var p=e.drugspec.split(":"),f=0;f<p.length;f++)-1!=p[f].indexOf(e.spec)&&(n.dedosAgeUnits=p[f].split(e.spec)[0],n.dosAgeUnits=p[f].split(e.spec)[0]+e.spec);else n.dedosAgeUnits=e.drugspec.split(e.spec)[0],n.dosAgeUnits=e.drugspec.split(e.spec)[0]+e.spec;this.form.outs.push(n);var v=this.form.outs;this.form.outs=[],1===v.length?this.currentindex="0":this.currentindex=v.length-1+"",this.form.outs=v,this.isshowall=!1,this.currentdrugindex=v.length-1,this.modal1=!1}else if(!this.timestate){this.timestate=!0,this.$Message.warning({content:"该药品已选择，请选择其他药品！",duration:1});var h=setInterval(function(){t.timestate=!1,clearInterval(h)},1100)}},searchCombination:function(){var e=this,t=e.$store.getters.getUrl+"prescription/getMakeUpPrescribe.do",s=JSON.parse(localStorage.getItem("yspatientinfo")),i=(s.registerdept,s.doctor,$.ajax({url:t,type:"post",dataType:"json",timeout:15e3,data:{departcode:"100109",doctorno:"000WGC"},success:function(t){1==t.status&&(e.modal11=!0,e.searchdrugses=t.data)},error:function(e){},complete:function(t,s){"timeout"==s&&(i.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}}))},getpatientinfo:function(){var e=localStorage.getItem("yspatientinfo"),t=JSON.parse(e);this.form.name=t.name,this.form.cardno=t.patientid,this.form.orderby=t.registerdept,this.form.depname=t.hosdepname,this.form.docname=t.hosdocname,this.form.doccode=t.doctor,this.form.openid=t.openid,this.form.starttime=t.starttime,this.form.visitno=t.visitno,this.form.clinicno=t.clinicno}}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"prescription-page"},[s("div",{staticClass:"rowwrapper"},[e._m(0),e._v(" "),s("Input",{attrs:{disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),s("div",{staticClass:"rowwrapper"},[e._m(1),e._v(" "),s("Input",{attrs:{disabled:""},model:{value:e.form.cardno,callback:function(t){e.$set(e.form,"cardno",t)},expression:"form.cardno"}})],1),e._v(" "),s("div",{staticClass:"rowwrapper"},[e._m(2),e._v(" "),s("Input",{attrs:{disabled:""},model:{value:e.form.depname,callback:function(t){e.$set(e.form,"depname",t)},expression:"form.depname"}})],1),e._v(" "),s("div",{staticClass:"rowwrapper"},[e._m(3),e._v(" "),s("Input",{attrs:{disabled:""},model:{value:e.form.docname,callback:function(t){e.$set(e.form,"docname",t)},expression:"form.docname"}})],1),e._v(" "),s("div",{staticClass:"rowwrapper"},[e._m(4),e._v(" "),s("Input",{attrs:{disabled:""},model:{value:e.form.orderclass,callback:function(t){e.$set(e.form,"orderclass",t)},expression:"form.orderclass"}})],1),e._v(" "),s("div",{staticClass:"add-btn",on:{click:e.showdrugmodal}},[e._v("\n        请添加药品\n    ")]),e._v(" "),s("div",{staticClass:"add-btn",on:{click:e.searchCombination}},[e._v("\n        请添加组合\n    ")]),e._v(" "),void 0==e.form.outs||e.form.outs.length<=0?s("div",{staticClass:"drug-tip"},[s("div",[e._v("\n            请添加药品\n        ")])]):e._e(),e._v(" "),void 0!==e.form.outs&&e.form.outs.length>0?s("div",[e._l(e.form.outs,function(t,i){return s("div",{key:i,staticClass:"rowwrapper"},[s("div",{staticClass:"drugname"},[e._v("\n                "+e._s(t.drugName)+"  \n            ")]),e._v(" "),s("div",{staticClass:"detaile",on:{click:function(t){return e.editdrugdetail(i)}}},[e._v("\n                详情\n            ")]),e._v(" "),s("div",{staticClass:"detaile",on:{click:function(t){return e.isdeletitem(i)}}},[e._v("\n                删除\n            ")])])}),e._v(" "),s("div",[s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                    用法：\n                ")]),e._v(" "),s("Select",{attrs:{"label-in-value":""},model:{value:e.east.administretion,callback:function(t){e.$set(e.east,"administretion",t)},expression:"east.administretion"}},e._l(e.channel,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                    "+e._s("")+"\n                ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[e._m(5),e._v(" "),s("Select",{attrs:{"label-in-value":""},model:{value:e.east.frequency,callback:function(t){e.$set(e.east,"frequency",t)},expression:"east.frequency"}},e._l(e.frequency,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                    "+e._s("")+"\n                ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[e._m(6),e._v(" "),s("Select",{attrs:{"label-in-value":""},model:{value:e.east.freq,callback:function(t){e.$set(e.east,"freq",t)},expression:"east.freq"}},e._l(e.frequency,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                    "+e._s("")+"\n                ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                    剂数：\n                ")]),e._v(" "),s("Input",{attrs:{type:"number"},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.east.repetition,callback:function(t){e.$set(e.east,"repetition",t)},expression:"east.repetition"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                    剂\n                ")])],1)])]),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},on:{touchstart:e.touchstart,touchend:e.touchend,click:e.toinsertprescribe}},[e._v("提交")])])],2):e._e(),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"药品详情"},model:{value:e.isshowdrugs,callback:function(t){e.isshowdrugs=t},expression:"isshowdrugs"}},e._l(e.form.outs,function(t,i){return s("div",{directives:[{name:"show",rawName:"v-show",value:e.currentdrugindex==i||e.isshowall,expression:"currentdrugindex==index||isshowall"}],key:i},[s("div",{staticClass:"drug-item",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"drugName"},[e._v(e._s(t.drugName)+"\n                ")]),e._v(" "),s("div",{staticClass:"drugSpec"},[e._v("规格："+e._s(t.drugSpec))]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                            每次用量：\n                        ")]),e._v(" "),s("Input",{attrs:{type:"number"},model:{value:t.dosAge,callback:function(s){e.$set(t,"dosAge",s)},expression:"item.dosAge"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                            "+e._s(t.dosAgeUnits)+"\n                        ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                            单价：\n                        ")]),e._v(" "),s("Input",{attrs:{type:"text",disabled:""},model:{value:t.price,callback:function(s){e.$set(t,"price",s)},expression:"item.price"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                            元\n                        ")])],1)])])])}),0),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"选择药品"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[s("div",{staticClass:"search-box-wrapper"},[s("div",{staticClass:"search-box"},[s("Input",{on:{"on-change":e.dealsearchDrug},model:{value:e.drugName,callback:function(t){e.drugName=t},expression:"drugName"}})],1),e._v(" "),void 0!==e.searchdruglist||e.searchdruglist.length>0?s("div",{staticClass:"search-yplist"},e._l(e.searchdruglist,function(t,i){return s("div",{key:i},[s("div",{staticClass:"search-ypnameitem ",on:{click:function(s){return e.adddrug(t)}}},[s("div",{staticClass:"ypname"},[e._v(e._s(t.ypname))]),e._v(" "),s("div",{staticClass:"ypinventory"},[e._v(e._s(t.inventory))])])])}),0):e._e(),e._v(" "),void 0===e.searchdruglist||e.searchdruglist.length<=0?s("div",{staticClass:"search-tip"},[e._v("\n                没有搜索到该药品\n            ")]):e._e()])]),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"选择药品组合"},model:{value:e.modal11,callback:function(t){e.modal11=t},expression:"modal11"}},[s("div",{staticClass:"search-box-wrapper"},[s("div",{staticClass:"search-box",on:{click:function(t){return e.demo()}}},[s("Input",{attrs:{disabled:"",placeholder:"选择药品组合"},model:{value:e.drugNamees,callback:function(t){e.drugNamees=t},expression:"drugNamees"}})],1),e._v(" "),void 0!==e.searchdrugses||e.searchdrugses.length>0?s("div",{staticClass:"search-yplist box"},e._l(e.searchdrugses,function(t,i){return s("div",{key:i},[s("div",{staticClass:"search-ypnameitem ",on:{click:function(s){return e.dealsearchDrugses(t)}}},[s("div",{staticClass:"ypname"},[e._v(e._s(t.title))])])])}),0):e._e(),e._v(" "),void 0===e.searchdrugses||e.searchdrugses.length<=0?s("div",{staticClass:"search-tip"},[e._v("\n                没有搜索到该药品\n            ")]):e._e()])]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":e.deletoutsitem},model:{value:e.isshowtip,callback:function(t){e.isshowtip=t},expression:"isshowtip"}},[e._v("\n        请确认是否删除该药品！\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":e.insertprescribe},model:{value:e.isinsertprescribe,callback:function(t){e.isinsertprescribe=t},expression:"isinsertprescribe"}},[e._v("\n        请确认是否提交\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.requestmodel,callback:function(t){e.requestmodel=t},expression:"requestmodel"}},[e._v("\n        "+e._s(e.infomsg)+"\n    ")]),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshowloading,expression:"isshowloading"}],staticClass:"loading"})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"info-title"},[t("span",[this._v("患者姓名:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"info-title"},[t("span",[this._v("患者卡号:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"info-title"},[t("span",[this._v("就诊科室:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"info-title"},[t("span",[this._v("就诊医生:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"info-title"},[t("span",[this._v("医嘱类别:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"lititle"},[t("span",[this._v("\n                        频次：\n                    ")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"lititle"},[t("span",[this._v("\n                        服用次数：\n                    ")])])}]};var g=s("VU/8")(v,h,!1,function(e){s("tLa1")},"data-v-d1e4ece2",null);t.default=g.exports},"0kI5":function(e,t){},"8pTZ":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Xxa5"),n=s.n(i),a=s("exGp"),r=s.n(a),o=s("mvHQ"),c=s.n(o),l=s("//Fk"),u=s.n(l),d={components:{loading:s("T4ej").a},data:function(){return{requestmodel:!1,infomsg:"",modal3:!1,issubmit:!1,projectmodel:!1,isshow:!1,modal1:!1,inputsize:{minRows:6,maxRows:6},opacity:1,depname:"检验科",position:"二楼东侧",form:{examclass:"",patientid:"",performedby:"",sysdate:"",visitdate:"",reqdept:"",reqphysician:"",doctorno:"",itemcode:"",itemname:"",chargetype:"",clinicno:"",visitno:""},projectname:[],checklist:[],dealchecklist:[],projectnamelist:[],dealprojectnamelist:[]}},methods:{tosubmit:function(){this.issubmit=!0},showmodel:function(){this.projectmodel=!0},inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},topath:function(){this.$router.push("/registeredlist")},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},insertPatientAssay:function(e){var t=new Date,s=t.getFullYear(),i=t.getMonth()+1,n=t.getDate();i<10&&(i="0"+i),n<10&&(n="0"+n);var a=s+"-"+i+"-"+n,r=this.depname,o=this.form.examclass,l=localStorage.getItem("yspatientinfo"),d=JSON.parse(l),m=d.name,p=d.openid,f=this,v=f.$store.getters.getUrl+"chemicalexam/insertPatientAssay.do";return new u.a(function(t,s){var i=$.ajax({url:v,type:"post",dataType:"json",timeout:15e3,async:!0,data:{assaydata:c()(e),visitdate:a,subclass:r,items:o,openid:p,username:m,position:f.position},success:function(e){f.isshow=!1,t(e.status)},error:function(e){f.isshow=!1,t(e)},complete:function(e,t){"timeout"==t&&(i.abort(),f.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},submit:function(){var e=this;return r()(n.a.mark(function t(){var s,i,a,r,o,l;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isshow=!0,s=e,0!=e.projectname.length){t.next=6;break}return e.isshow=!1,e.modal3=!0,t.abrupt("return");case 6:for(i=[],a=0;a<e.projectname.length;a++){for(o in r={},e.form)r[o]=e.form[o];r.itemcode=e.projectname[a].item_code,r.itemname=e.projectname[a].item_name,r.specimen=e.projectname[a].expand1,i.push(r)}return t.next=10,e.insertPatientAssay(i);case 10:l=t.sent,s.isshow=!1,"1"==l?(s.$Message.info("提交成功！"),window.websocketobj.send(c()({cardno:s.form.patientid,massege:"123"})),s.init()):s.modal1=!0;case 13:case"end":return t.stop()}},t,e)}))()},changeproject:function(e){if(this.projectname=[],0!=e.length)for(var t=0;t<this.projectnamelist.length;t++)for(var s=0;s<e.length;s++)this.projectnamelist[t].item_name==e[s]&&this.projectname.push(this.projectnamelist[t])},_fetchprojectnamelist:function(e,t){var s=this;return new u.a(function(i,n){s.isshow=!0;var a=s.$store.getters.getUrl+"chemicalexam/getassaysecondclass.do";$.ajax({url:a,type:"post",dataType:"json",async:!1,data:{expand3:e,expand2:t},success:function(e){s.isshow=!1,i(e)},error:function(e){s.isshow=!1;i({status:5})}})})},deleteitem:function(e,t){for(var s=0;s<this.projectname.length;s++)this.projectname[s].item_name==e&&this.projectname.splice(t,1);this.dealprojectnamelist.splice(t,1)},changeexamclass:function(e){var t=this;return r()(n.a.mark(function s(){var i,a,r;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(e){s.next=2;break}return s.abrupt("return");case 2:for((i=t).dealprojectnamelist=[],i.projectname=[],a=0;a<t.checklist.length;a++)t.checklist[a].class_name==e&&(t.form.examclass=t.checklist[a].class_name,t.form.performedby=t.checklist[a].dept_code);return s.next=8,i._fetchprojectnamelist(t.form.performedby,t.form.examclass);case 8:"1"==(r=s.sent).status?i.projectnamelist=r.data:5==r.status?(i.infomsg="请求发送失败",i.requestmodel=!0):(i.infomsg="获取数据失败",i.requestmodel=!0);case 10:case"end":return s.stop()}},s,t)}))()},_dealchemicalexamlist:function(e){this.checklist=e;for(var t=[],s=0;s<e.length;s++)if(e[s].class_name){var i={value:e[s].class_name,label:e[s].class_name};t.push(i)}return t},_fetchchemicalexamlist:function(){var e=this;return new u.a(function(t,s){var i=e;i.isshow=!0;var n=i.$store.getters.getUrl+"chemicalexam/getassayclass.do",a=$.ajax({url:n,type:"post",dataType:"json",timeout:15e3,async:!0,data:"",success:function(e){i.isshow=!1,t(e)},error:function(e){i.isshow=!1;t({status:5})},complete:function(e,t){"timeout"==t&&(a.abort(),i.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},init:function(){var e=this;return r()(n.a.mark(function t(){var s,i,a,r,o,c,l;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.form.patientid="",e.form.performedby="",e.form.sysdate="",e.form.visitdate="",e.form.reqdept="",e.form.reqphysician="",e.form.doctorno="",e.form.itemcode="",e.form.itemname="",e.depname="检验科",e.form.examclass="",e.form.chargetype="",e.form.clinicno="",e.form.visitno="",e.projectname=[],e.checklist=[],e.dealchecklist=[],e.projectnamelist=[],e.dealprojectnamelist=[],t.next=4,e._fetchchemicalexamlist();case 4:if(5!=(s=t.sent).status){t.next=9;break}return e.infomsg="请求发送失败",e.requestmodel=!0,t.abrupt("return");case 9:if("1"==s.status){t.next=13;break}return e.infomsg="获取数据失败",e.requestmodel=!0,t.abrupt("return");case 13:e.dealchecklist=e._dealchemicalexamlist(s.data),i=localStorage.getItem("yspatientinfo"),a=JSON.parse(i),e.form.reqphysician=a.hosdocname,e.form.doctorno=a.doctor,e.form.reqdept=a.registerdept,e.form.patientid=a.patientid,e.form.clinicno=a.clinicno,e.form.visitno=a.visitno,r=new Date,o=r.getFullYear(),c=r.getMonth()+1,l=r.getDate(),e.form.sysdate=o+"-"+c+"-"+l,c<10&&(c="0"+c),l<10&&(l="0"+l),e.form.visitdate=o+"-"+c+"-"+l;case 30:case"end":return t.stop()}},t,e)}))()}},mounted:function(){this.init()}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"writecheck-page"},[s("div",{staticClass:"content"},[s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                化验类别:\n            ")]),e._v(" "),s("Select",{attrs:{placeholder:""},on:{"on-change":e.changeexamclass},model:{value:e.form.examclass,callback:function(t){e.$set(e.form,"examclass",t)},expression:"form.examclass"}},e._l(e.dealchecklist,function(t,i){return s("Option",{key:i,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                执行科室:\n            ")]),e._v(" "),s("Input",{staticClass:"input-item",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.depname,callback:function(t){e.depname=t},expression:"depname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                申请医生:\n            ")]),e._v(" "),s("Input",{staticClass:"input-item",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.reqphysician,callback:function(t){e.$set(e.form,"reqphysician",t)},expression:"form.reqphysician"}})],1),e._v(" "),e.form.examclass?s("div",{staticClass:"add-btn",on:{click:e.showmodel}},[e._v("\n            添加项目\n        ")]):e._e(),e._v(" "),e._l(e.projectname,function(t,i){return s("div",{key:i,staticClass:"input-wrapper"},[e._v("\n            "+e._s(t.item_name)),s("div",{on:{click:function(s){return e.deleteitem(t.item_name,i)}}},[e._v("删除")])])})],2),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},on:{touchstart:e.touchstart,touchend:e.touchend,click:e.tosubmit}},[e._v("提交")])]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.requestmodel,callback:function(t){e.requestmodel=t},expression:"requestmodel"}},[s("p",[e._v(e._s(e.infomsg))])]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[s("p",[e._v("开化验失败")])]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":e.submit},model:{value:e.issubmit,callback:function(t){e.issubmit=t},expression:"issubmit"}},[e._v("\n        请确认是否提交\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal3,callback:function(t){e.modal3=t},expression:"modal3"}},[s("p",[e._v("内容不全禁止提交")])]),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"化验项目"},model:{value:e.projectmodel,callback:function(t){e.projectmodel=t},expression:"projectmodel"}},[s("CheckboxGroup",{attrs:{size:"large"},on:{"on-change":e.changeproject},model:{value:e.dealprojectnamelist,callback:function(t){e.dealprojectnamelist=t},expression:"dealprojectnamelist"}},e._l(e.projectnamelist,function(e,t){return s("Checkbox",{key:t,staticClass:"Checkbox",attrs:{size:"large",label:e.item_name}})}),1)],1),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"isshow"}]})],1)},staticRenderFns:[]};var p=s("VU/8")(d,m,!1,function(e){s("sS1n")},"data-v-2da352bc",null);t.default=p.exports},CGhd:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Xxa5"),n=s.n(i),a=s("exGp"),r=s.n(a),o=s("//Fk"),c=s.n(o),l=s("mvHQ"),u=s.n(l),d=s("T4ej"),m=s("NG4M"),p=s.n(m),f={components:{loading:d.a},data:function(){return{questmodel:!1,infomsg:"",isshowcontent:!0,issubmitstate:!1,isshowloading:!1,ysrecordstate:1,btnvalue:"提交",modalcurrentvalue:"",currentvalue:"",isshowinput:!1,modal1:!1,inputsize:{minRows:8,maxRows:8},littleinputsize:{minRows:3,maxRows:3},opacity:1,value11:"",marry:"",form:{cardno:"",visitdate:"",visitno:" ",illnessdesc:"",anamnesis:"",familyall:"",marrital:"",individual:"",menses:"",medhistory:"",bodyexam:"",diagdesc:"",advice:"",doctor:"",ordinal:"1",operationrecord:"",medicalrecord:"",doctorno:"",memo:"",maternity:""},ruleValidate:{illnessdesc:[{type:"string",max:100,message:"主诉不能多于100个字",trigger:"change"}],anamnesis:[{type:"string",max:100,message:"既往史不能多于100个字",trigger:"change"}],maternity:[{type:"string",max:40,message:"婚孕史不能多于40个字",trigger:"change"}],marrital:[{type:"string",max:2,message:"婚姻不能多于2个字",trigger:"change"}],menses:[{type:"string",max:40,message:"月经史不能多于40个字",trigger:"change"}],individual:[{type:"string",max:40,message:"过敏史不能多于40个字",trigger:"change"}],familyall:[{type:"string",max:40,message:"主诉不能多于40个字",trigger:"change"}],medhistory:[{type:"string",max:1e3,message:"现病史不能多于1000个字",trigger:"change"}],operationrecord:[{type:"string",max:1e3,message:"处理不能多于1000个字",trigger:"change"}],bodyexam:[{type:"string",max:500,message:"主诉不能多于500个字",trigger:"change"}],medicalrecord:[{type:"string",max:1e3,message:"辅助检查不能多于1000个字",trigger:"change"}],diagdesc:[{type:"string",max:80,message:"诊断不能多于80个字",trigger:"change"}],advice:[{type:"string",max:80,message:"建议不能多于80个字",trigger:"change"}],memo:[{type:"string",max:80,message:"备注不能多于80个字",trigger:"change"}],doctor:[{type:"string",max:80,message:"备注不能多于80个字",trigger:"change"}]},patientinname:""}},methods:{issubmit:function(){this.issubmitstate=!0},changeisshowcontent:function(){this.isshowcontent=!0},showinput:function(e,t){this.isshowcontent=!1,this.focusstate=!1,this.isshowinput=!0,this.currentvalue=e,this.modalcurrentvalue=t},inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},topath:function(){this.$router.push("/registeredlist")},editinsert:function(e){var t=this;if(""!=e.diagdesc){var s=t.$store.getters.getUrl+"medicalrecord/updatemedicalrecord.do";t.isshowloading=!0;e.cardno;$.ajax({url:s,type:"post",dataType:"json",async:!1,data:{cardno:p()(e.cardno),visitno:e.visitno,illnessdesc:e.illnessdesc,anamnesis:e.anamnesis,familyall:e.familyall,marrital:e.marrital,individual:e.individual,menses:e.menses,medhistory:e.medhistory,bodyexam:e.bodyexam,diagdesc:e.diagdesc,advice:e.advice,operationrecord:e.operationrecord,medicalrecord:e.medicalrecord,memo:e.memo,maternity:e.maternity},success:function(e){t.isshowloading=!1,"1"==e.status?(t.$Message.info("修改成功！"),window.websocketobj.send(u()({cardno:t.form.cardno,massege:"123"}))):(t.isshowloading=!1,t.questmodel=!0,t.infomsg="修改失败！")},error:function(e){t.isshowloading=!1,t.questmodel=!0,t.infomsg="请求发送失败"}})}else this.modal1=!0},insert:function(e){var t=this,s=t.$store.getters.getUrl+"medicalrecord/insertmedicalrecord.do";if(""!=e.diagdesc){this.isshowloading=!0;e.cardno;var i={cardno:e.cardno,visitdate:e.visitdate,visitno:e.visitno,illnessdesc:e.illnessdesc,anamnesis:e.anamnesis,familyall:e.familyall,marrital:e.marrital,individual:e.individual,menses:e.menses,medhistory:e.medhistory,bodyexam:e.bodyexam,diagdesc:e.diagdesc,advice:e.advice,doctor:e.doctor,ordinal:"1",operationrecord:e.operationrecord,medicalrecord:e.medicalrecord,doctorno:e.doctorno,memo:e.memo,maternity:e.maternity};$.ajax({url:s,type:"post",dataType:"json",async:!1,contentType:"application/json",data:u()(i),success:function(e){t.isshowloading=!1,"1"==e.status?(t.$Message.info("病历提交成功"),localStorage.setItem("ysrecordstate",5),t.ysrecordstate=5,window.websocketobj.send(u()({cardno:t.form.cardno,massege:"123"}))):(t.isshowloading=!1,t.questmodel=!0,t.infomsg="病历提交失败！")},error:function(e){t.isshowloading=!1,t.questmodel=!0,t.infomsg="请求发送失败"}})}else this.modal1=!0},submit:function(e){var t=this;this.issubmitstate=!1;var s=new Date,i=s.getFullYear(),n=s.getMonth()+1,a=s.getDate();n<10&&(n="0"+n),a<10&&(a="0"+a),this.form.visitdate=i+"-"+n+"-"+a,this.$refs[e].validate(function(e){e&&(1==localStorage.getItem("ysrecordstate")?t.insert(t.form):t.editinsert(t.form))})},getcurrentdayrecord:function(){var e=this,t=JSON.parse(localStorage.getItem("yspatientinfo")),s=t.patientid,i=t.visitno,n=new Date,a=n.getFullYear(),r=n.getMonth()+1,o=n.getDate();r<10&&(r="0"+r),o<10&&(o="0"+o);var c=a+"-"+r+"-"+o,l=t.doctor;this.isshowloading=!0;var u=e.$store.getters.getUrl+"medicalrecord/getthesamedayoutpmr.do",d=$.ajax({url:u,type:"post",dataType:"json",timeout:15e3,async:!0,data:{patientid:s,visitdate:c,doccode:l,visitno:i},success:function(t){if(e.isshowloading=!1,"1"==t.status){e.ysrecordstate=5,localStorage.setItem("ysrecordstate",5);var s=t.data[0];for(var i in s)for(var n in e.form)i==n?e.form[n]=s[i]:"maternitl"==i?e.form.maternity=s.maternitl:"familyill"==i?e.form.familyall=s.familyill:"openrationrecord"==i?e.form.operationrecord=s.openrationrecord:"bodymeax"==i&&(e.form.bodyexam=s.bodymeax)}else"-1"==t.status?(recordstate=-1,e.questmodel=!0,e.infomsg="系统异常"):"0"==t.status&&(e.ysrecordstate=1,localStorage.setItem("ysrecordstate",1),e.unrecord())},error:function(t){recordstate=1,e.isshowloading=!1,e.questmodel=!0,e.infomsg="请求发送失败"},complete:function(t,s){"timeout"==s&&(d.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},fetchMegetMedicalLast:function(){var e=this;return new c.a(function(t,s){var i=e,n=JSON.parse(localStorage.getItem("yspatientinfo")).patientid,a=i.$store.getters.getUrl+"medicalrecord/MegetMedicalLast.do",r=$.ajax({url:a,type:"post",dataType:"json",timeout:15e3,async:!0,data:{cardno:n},success:function(e){t(e)},error:function(e){t({status:5})},complete:function(e,t){"timeout"==t&&(r.abort(),i.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},unrecord:function(){var e=this;return r()(n.a.mark(function t(){var s,i,a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e,i=JSON.parse(localStorage.getItem("yspatientinfo")),e.form.docName=i.hosdocname,e.form.doctorno=i.doctor,e.form.doctor=i.hosdocname,t.next=7,e.fetchMegetMedicalLast();case 7:"1"==(a=t.sent).status?((r=a.data[0]).medhistory?e.form.medhistory=r.medhistory:e.form.medhistory="",r.anamnesis?e.form.anamnesis=r.anamnesis:e.form.anamnesis="",r.individual?e.form.individual=r.individual:e.form.individual="",r.menses?e.form.menses=r.menses:e.form.menses="",r.familyill?e.form.familyall=r.familyill:e.form.familyall=""):5==a.status?(s.questmodel=!0,s.infomsg="请求发送失败"):"0"==a.status||(s.questmodel=!0,s.infomsg="获取病史系统异常");case 9:case"end":return t.stop()}},t,e)}))()},init:function(){var e=this;return r()(n.a.mark(function t(){var s,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e,s=localStorage.getItem("yspatientinfo"),i=JSON.parse(s),e.patientinname=i.name,e.form.cardno=i.patientid,e.form.visitno=i.visitno,e.getcurrentdayrecord(),e.isshowloading=!1;case 8:case"end":return t.stop()}},t,e)}))()}},mounted:function(){this.isshowloading=!0;var e=this;setTimeout(function(){e.init()},10)}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"writecheck-page"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isshowcontent,expression:"isshowcontent"}],staticClass:"content"},[s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                患者姓名:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},model:{value:e.patientinname,callback:function(t){e.patientinname=t},expression:"patientinname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("illnessdesc","主诉")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                主诉:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.illnessdesc,callback:function(t){e.$set(e.form,"illnessdesc",t)},expression:"form.illnessdesc"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("anamnesis","既往史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                既往史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.anamnesis,callback:function(t){e.$set(e.form,"anamnesis",t)},expression:"form.anamnesis"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("maternity","婚孕史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                婚孕史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.maternity,callback:function(t){e.$set(e.form,"maternity",t)},expression:"form.maternity"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                婚姻:\n            ")]),e._v(" "),s("Select",{attrs:{placeholder:""},model:{value:e.form.marrital,callback:function(t){e.$set(e.form,"marrital",t)},expression:"form.marrital"}},[s("Option",{attrs:{value:"已婚"}},[e._v("已婚")]),e._v(" "),s("Option",{attrs:{value:"未婚"}},[e._v("未婚")])],1)],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("menses","月经史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                月经史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.menses,callback:function(t){e.$set(e.form,"menses",t)},expression:"form.menses"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("individual","过敏史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                过敏史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",staticStyle:{border:"none"},attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.individual,callback:function(t){e.$set(e.form,"individual",t)},expression:"form.individual"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("familyall","家族史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                家族史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.familyall,callback:function(t){e.$set(e.form,"familyall",t)},expression:"form.familyall"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("medhistory","现病史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                现病史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medhistory,callback:function(t){e.$set(e.form,"medhistory",t)},expression:"form.medhistory"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("operationrecord","处理")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                处理:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.operationrecord,callback:function(t){e.$set(e.form,"operationrecord",t)},expression:"form.operationrecord"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("bodyexam","查体")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                查体:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.bodyexam,callback:function(t){e.$set(e.form,"bodyexam",t)},expression:"form.bodyexam"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("medicalrecord","辅助检查")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                辅助检查:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medicalrecord,callback:function(t){e.$set(e.form,"medicalrecord",t)},expression:"form.medicalrecord"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("diagdesc","诊断")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                诊断:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.diagdesc,callback:function(t){e.$set(e.form,"diagdesc",t)},expression:"form.diagdesc"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("advice","建议")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                建议:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.advice,callback:function(t){e.$set(e.form,"advice",t)},expression:"form.advice"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("memo","备注")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                备注:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1)]),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},on:{touchstart:e.touchstart,touchend:e.touchend,click:function(t){return e.issubmit("formValidate")}}},[e._v("\n            "+e._s(1==e.ysrecordstate?"提交":"修改病历")+"\n        ")])]),e._v(" "),s("Modal",{attrs:{title:e.modalcurrentvalue,closable:!1,fullscreen:""},on:{"on-ok":e.changeisshowcontent,"on-cancel":e.changeisshowcontent},model:{value:e.isshowinput,callback:function(t){e.isshowinput=t},expression:"isshowinput"}},[s("Form",{ref:"formValidate",attrs:{model:e.form,rules:e.ruleValidate}},[s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"patientinname"==e.currentvalue,expression:"currentvalue=='patientinname'"}],attrs:{prop:"patientinname"}},[s("Input",{attrs:{disabled:""},model:{value:e.patientinname,callback:function(t){e.patientinname=t},expression:"patientinname"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"illnessdesc"==e.currentvalue,expression:"currentvalue=='illnessdesc'"}],attrs:{prop:"illnessdesc"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.illnessdesc,callback:function(t){e.$set(e.form,"illnessdesc",t)},expression:"form.illnessdesc"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"anamnesis"==e.currentvalue,expression:"currentvalue=='anamnesis'"}],attrs:{prop:"anamnesis"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.anamnesis,callback:function(t){e.$set(e.form,"anamnesis",t)},expression:"form.anamnesis"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"maternity"==e.currentvalue,expression:"currentvalue=='maternity'"}],attrs:{prop:"maternity"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.maternity,callback:function(t){e.$set(e.form,"maternity",t)},expression:"form.maternity"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"marrital"==e.currentvalue,expression:"currentvalue=='marrital'"}],attrs:{prop:"marrital"}},[s("Select",{model:{value:e.form.marrital,callback:function(t){e.$set(e.form,"marrital",t)},expression:"form.marrital"}},[s("Option",{attrs:{value:"已婚"}},[e._v("已婚")]),e._v(" "),s("Option",{attrs:{value:"未婚"}},[e._v("未婚")])],1)],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"menses"==e.currentvalue,expression:"currentvalue=='menses'"}],attrs:{prop:"menses"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.menses,callback:function(t){e.$set(e.form,"menses",t)},expression:"form.menses"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"individual"==e.currentvalue,expression:"currentvalue=='individual'"}],attrs:{prop:"individual"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.individual,callback:function(t){e.$set(e.form,"individual",t)},expression:"form.individual"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"familyall"==e.currentvalue,expression:"currentvalue=='familyall'"}],attrs:{prop:"familyall"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.familyall,callback:function(t){e.$set(e.form,"familyall",t)},expression:"form.familyall"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"medhistory"==e.currentvalue,expression:"currentvalue=='medhistory'"}],attrs:{prop:"medhistory"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medhistory,callback:function(t){e.$set(e.form,"medhistory",t)},expression:"form.medhistory"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"operationrecord"==e.currentvalue,expression:"currentvalue=='operationrecord'"}],attrs:{prop:"operationrecord"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.operationrecord,callback:function(t){e.$set(e.form,"operationrecord",t)},expression:"form.operationrecord"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"bodyexam"==e.currentvalue,expression:"currentvalue=='bodyexam'"}],attrs:{prop:"bodyexam"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.bodyexam,callback:function(t){e.$set(e.form,"bodyexam",t)},expression:"form.bodyexam"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"medicalrecord"==e.currentvalue,expression:"currentvalue=='medicalrecord'"}],attrs:{prop:"medicalrecord"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medicalrecord,callback:function(t){e.$set(e.form,"medicalrecord",t)},expression:"form.medicalrecord"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"diagdesc"==e.currentvalue,expression:"currentvalue=='diagdesc'"}],attrs:{prop:"diagdesc"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.diagdesc,callback:function(t){e.$set(e.form,"diagdesc",t)},expression:"form.diagdesc"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"advice"==e.currentvalue,expression:"currentvalue=='advice'"}],attrs:{prop:"advice"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.advice,callback:function(t){e.$set(e.form,"advice",t)},expression:"form.advice"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"memo"==e.currentvalue,expression:"currentvalue=='memo'"}],attrs:{prop:"memo"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"doctor"==e.currentvalue,expression:"currentvalue=='doctor'"}],attrs:{prop:"doctor"}},[s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.doctor,callback:function(t){e.$set(e.form,"doctor",t)},expression:"form.doctor"}})],1)],1)],1),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[e._v("\n        请填写诊断！\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":function(t){return e.submit("formValidate")}},model:{value:e.issubmitstate,callback:function(t){e.issubmitstate=t},expression:"issubmitstate"}},[e._v("\n        请确认是否提交！\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.questmodel,callback:function(t){e.questmodel=t},expression:"questmodel"}},[e._v("\n        "+e._s(e.infomsg)+"\n    ")]),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshowloading,expression:"isshowloading"}]})],1)},staticRenderFns:[]};var h=s("VU/8")(f,v,!1,function(e){s("YCsJ")},"data-v-62882f50",null);t.default=h.exports},FVwl:function(e,t,s){var i=s("0Zbq").FilterCSS,n=s("oz9r"),a=s("krhF"),r=a.parseTag,o=a.parseAttr,c=s("noAI");function l(e){return void 0===e||null===e}function u(e){(e=function(e){var t={};for(var s in e)t[s]=e[s];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=n.onIgnoreTagStripAll),e.whiteList=e.whiteList||n.whiteList,e.onTag=e.onTag||n.onTag,e.onTagAttr=e.onTagAttr||n.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||n.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||n.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||n.safeAttrValue,e.escapeHtml=e.escapeHtml||n.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new i(e.css))}u.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,s=t.whiteList,i=t.onTag,a=t.onIgnoreTag,u=t.onTagAttr,d=t.onIgnoreTagAttr,m=t.safeAttrValue,p=t.escapeHtml,f=this.cssFilter;t.stripBlankChar&&(e=n.stripBlankChar(e)),t.allowCommentTag||(e=n.stripCommentTag(e));var v=!1;if(t.stripIgnoreTagBody){v=n.StripTagBody(t.stripIgnoreTagBody,a);a=v.onIgnoreTag}var h=r(e,function(e,t,n,r,v){var h,g={sourcePosition:e,position:t,isClosing:v,isWhite:s.hasOwnProperty(n)};if(!l(h=i(n,r,g)))return h;if(g.isWhite){if(g.isClosing)return"</"+n+">";var y=function(e){var t=c.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var s="/"===(e=c.trim(e.slice(t+1,-1)))[e.length-1];return s&&(e=c.trim(e.slice(0,-1))),{html:e,closing:s}}(r),b=s[n],w=o(y.html,function(e,t){var s,i=-1!==c.indexOf(b,e);return l(s=u(n,e,t,i))?i?(t=m(n,e,t,f))?e+'="'+t+'"':e:l(s=d(n,e,t,i))?void 0:s:s});r="<"+n;return w&&(r+=" "+w),y.closing&&(r+=" /"),r+=">"}return l(h=a(n,r,g))?p(r):h},p);return v&&(h=v.remove(h)),h},e.exports=u},Gg9O:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("mvHQ"),n=s.n(i),a={components:{loading:s("T4ej").a},data:function(){return{unselectdrugmodel:!1,isfetchdrugs:!1,isinsertprescribe:!1,styleindex:-1,isshowtip:!1,deldrugindex:0,currentdrugindex:0,isshowall:!1,isshowdrugs:!1,opacity:1,timestate:!1,isshowloading:!1,searchdrugs:[],channel:[],frequency:[],searchdrugmodal:!1,drugName:"",searchdruglist:[],form:{name:"",cardno:"",visitno:"",clinicno:"",orderby:"",depname:"",docname:"",doccode:"",sumcharges:"",itemclass:"A",orderclass:"A",openid:"",starttime:"",nizhen:"",outs:[]}}},mounted:function(){var e=this;setTimeout(function(){e.initdata(),e.init()},10)},methods:{inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},topath:function(){this.$router.push("/examination")},init:function(){var e=this;setTimeout(function(){e.getcurrentdayrecord(),e.searchDrug(e.form.orderclass),e.getpatientinfo(),e.fetchchannel(),e.fetchfrequency()},10)},initdata:function(){this.unselectdrugmodel=!1,this.isfetchdrugs=!1,this.isinsertprescribe=!1,this.styleindex=-1,this.isshowtip=!1,this.deldrugindex=0,this.currentdrugindex=0,this.isshowall=!1,this.isshowdrugs=!1,this.opacity=1,this.timestate=!1,this.isshowloading=!1,this.searchdrugs=[],this.channel=[],this.frequency=[],this.searchdrugmodal=!1,this.drugName="",this.searchdruglist=[],this.form.name="",this.form.cardno="",this.form.visitno="",this.form.clinicno="",this.form.orderby="",this.form.depname="",this.form.docname="",this.form.doccode="",this.form.sumcharges="",this.form.openid="",this.form.starttime="",this.form.nizhen="",this.form.outs=[]},getcurrentdayrecord:function(){var e=this,t=JSON.parse(localStorage.getItem("yspatientinfo")),s=t.patientid,i=t.visitno,n=new Date,a=n.getFullYear(),r=n.getMonth()+1,o=n.getDate();r<10&&(r="0"+r),o<10&&(o="0"+o);var c=a+"-"+r+"-"+o,l=t.doctor,u=e.$store.getters.getUrl+"medicalrecord/getthesamedayoutpmr.do";e.isshowloading=!0;var d=$.ajax({url:u,type:"post",dataType:"json",async:!0,timeout:15e3,data:{patientid:s,visitdate:c,doccode:l,visitno:i},success:function(t){e.isshowloading=!1,1==t.status?e.form.nizhen=t.data[0].diagdesc:(e.requestmodel=!0,e.infomsg="获取数据失败")},error:function(t){e.isshowloading=!1,e.requestmodel=!0,e.infomsg="请求发送失败"},complete:function(t,s){"timeout"==s&&(d.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},showdrugmodal:function(){this.searchdrugmodal=!0,this.isfetchdrugs||(this.isshowloading=!0)},dealsearchDrug:function(){var e=this.drugName.toUpperCase(),t=this.searchdrugs;if(this.searchdruglist=[],""!==this.drugName)for(var s=0;s<t.length;s++)if(t[s].hasOwnProperty("ypname")&&"0"!=t[s].inventory){var i=t[s].ypname.toString(),n=t[s].inputcode.toString();(i.includes(e)||n.includes(e))&&this.searchdruglist.push(t[s])}},searchDrug:function(e){var t=this,s="";s="A"==e?t.$store.getters.getUrl+"prescription/westernmedicine.do":t.$store.getters.getUrl+"prescription/chinesemedicine.do";var i=$.ajax({url:s,type:"post",dataType:"json",async:!0,timeout:15e3,data:"",success:function(e){if(t.isshowloading=!1,t.isfetchdrugs=!0,"1"==e.status){for(var s=[],i=0;i<e.data.length;i++)"0"!==e.data[i].inventory&&s.push(e.data[i]);t.searchdrugs=s}else"0"==e.status?(t.requestmodel=!0,t.infomsg="暂无数据"):(t.requestmodel=!0,t.infomsg="系统异常")},error:function(e){t.isshowloading=!1,t.requestmodel=!0,t.infomsg="系统异常"},complete:function(e,s){"timeout"==s&&(i.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},getpatientinfo:function(){var e=localStorage.getItem("yspatientinfo"),t=JSON.parse(e);this.form.name=t.name,this.form.cardno=t.patientid,this.form.orderby=t.registerdept,this.form.depname=t.hosdepname,this.form.docname=t.hosdocname,this.form.doccode=t.doctor,this.form.openid=t.openid,this.form.starttime=t.starttime,this.form.visitno=t.visitno,this.form.clinicno=t.clinicno},dealfetchchannel:function(e){this.channel=[];for(var t=0;t<e.length;t++)this.channel.push({value:e[t].pcusename,label:e[t].pcusename})},fetchchannel:function(){var e=this,t=e.$store.getters.getUrl+"prescription/channel.do",s=$.ajax({url:t,type:"post",dataType:"json",timeout:15e3,async:!0,data:"",success:function(t){e.dealfetchchannel(t.data)},error:function(e){},complete:function(t,i){"timeout"==i&&(s.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},dealfetchfrequency:function(e){this.frequency=[{value:"一日一次",label:"一日一次"},{value:"一日二次",label:"一日二次"},{value:"一日三次",label:"一日三次"},{value:"一日四次",label:"一日四次"},{value:"一日五次",label:"一日五次"},{value:"一日六次",label:"一日六次"}]},fetchfrequency:function(){var e=this,t=e.$store.getters.getUrl+"prescription/frequency.do",s=$.ajax({url:t,type:"post",dataType:"json",timeout:15e3,async:!0,data:"",success:function(t){e.dealfetchfrequency(t.data)},error:function(e){},complete:function(t,i){"timeout"==i&&(s.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},editdrugdetail:function(e){this.styleindex=-1,"-1"==e?this.isshowall=!0:(this.isshowall=!1,this.currentdrugindex=e),this.isshowdrugs=!0},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},changefrequency:function(e){this.sumprice(e)},sumprice:function(e){if(e.amount&&e.dosAge&&e.frequency){var t=parseFloat(e.amount),s=e.price.toString().split("."),i=s[1].length,n=0;if(0==s[0]){var a=e.price*Math.pow(10,i);n=parseInt(a)}else n=e.price*Math.pow(10,i);e.charges=t*n/Math.pow(10,i),e.costs=t*n/Math.pow(10,i);var r=void 0;"一日一次"==e.frequency?r=1:"一日二次"==e.frequency?r=2:"一日三次"==e.frequency?r=3:"一日四次"==e.frequency?r=4:"一日五次"==e.frequency?r=5:"一日六次"==e.frequency&&(r=6);var o,c=void 0,l=void 0;if("盒"==e.units){var u=e.drugSpec.split("*");c=t*parseInt(u[1]),l=Math.ceil(e.dosAge)*r}else c=t,l=Math.ceil(e.dosAge)*r;o=Math.ceil(c/l),e.abidance=o;for(var d=this.form.outs,m=0,p=0;p<d.length;p++){m+=parseInt(100*d[p].charges)/100}this.form.sumcharges=m}},isdeletitem:function(e){this.deldrugindex=e,this.isshowtip=!0},deletoutsitem:function(){this.form.outs.splice(this.deldrugindex,1);for(var e=this.form.outs,t=0,s=0;s<e.length;s++)t+=parseInt(100*e[s].charges)/100;this.form.sumcharges=t},fetchfirmid:function(e,t){var s=void 0,i=this,n=i.$store.getters.getUrl+"";return i.isshowloading=!0,$.ajax({url:n,type:"post",dataType:"json",async:!1,data:{itemcode:t,itemspec:e},success:function(e){i.isshowloading=!1,s=e},error:function(e){i.isshowloading=!1,s={status:5}}}),s},adddrug:function(e){var t=this;t.searchdrugmodal=!1,t.isshowall=!1,setTimeout(function(){for(var s=!0,i=0;i<t.form.outs.length;i++)t.form.outs[i].drugName==e.ypname&&(s=!1);if(s)if("A"==t.form.orderclass&&t.form.outs.length>=5)t.$Message.info("西药只能开五种药品！");else{var n={drugCode:"",drugName:"",drugSpec:"",firmId:"",units:"",dispensary:"",dispensarySub:"",price:"",amount:null,abidance:"",dosAge:"",dosAgeUnits:"",administretion:"",frequency:"",charges:0,costs:0,orderNo:"1",subOrderNo:"1",freqDetail:"医嘱说明",repetition:1};n.drugCode=e.ypcode,n.drugName=e.ypname,n.drugSpec=e.drugspec,n.units=e.unit,n.dispensary=e.storagecode,n.dispensarySub=e.substorage;var a=e.drugspec,r=e.ypcode,o=t.fetchfirmid(a,r);"0"==o.status?(t.requestmodel=!0,t.infomsg="暂无数据"):"1"==o.status?(n.firmId=o.data[0].firm_id,n.drugSpec=o.data[0].drug_spec+o.data[0].drug_supplier_id):"-1"==o.status?(t.requestmodel=!0,t.infomsg="系统异常查询药库失败"):(t.requestmodel=!0,t.infomsg="请求发送失败"),0===e.ypprice.toString().indexOf(".")?n.price="0"+e.ypprice:n.price=e.ypprice,e.unit,n.dosAgeUnits=e.unit,t.form.outs.push(n);var c=t.form.outs;t.isshowdrugs=!0,t.form.outs=[],setTimeout(function(){t.form.outs=c,t.currentdrugindex=c.length-1},10)}else if(!t.timestate){t.timestate=!0,t.$Message.warning({content:"该药品已选择，请选择其他药品！",duration:1});var l=setInterval(function(){t.timestate=!1,clearInterval(l)},1100)}},10)},toinsertprescribe:function(){this.isinsertprescribe=!0},checkouts:function(e){for(var t=!1,s=0;s<e.length;s++)for(var i in e[s]){if(""===e[s][i])return this.styleindex=s,this.$Message.warning("请把信息填写完整！"),t=!1,!1;t=!0}return t},insertprescribe:function(){var e=this;if(0!=e.form.outs.length){if(e.checkouts(e.form.outs)){var t=n()(e.form.outs),s={};s.outss=t,s.name=e.form.name,s.cardno=e.form.cardno,s.clinicno=e.form.clinicno,s.visitno=e.form.visitno,s.orderby=e.form.orderby,s.doctor=e.form.docname,s.doctorno=e.form.doccode,s.sumcharges=e.form.sumcharges,s.itemclass=e.form.itemclass,s.orderclass=e.form.orderclass,s.depname=e.form.depname,s.nizhen=e.form.nizhen;var i=e.$store.getters.getUrl+"prescription/prescribe.do?openid="+e.form.openid+"&starttime="+e.form.starttime;e.isshowloading=!0;var a=$.ajax({url:i,type:"post",dataType:"json",timeout:15e3,async:!0,contentType:"application/json",data:n()(s),success:function(t){e.isshowloading=!1,"1"===t.status?(e.$Message.info("开方成功"),e.initdata(),e.getcurrentdayrecord(),window.websocketobj.send(n()({cardno:e.form.cardno,massege:"123"})),e.init()):e.$Message.error("开方失败")},error:function(t){e.isshowloading=!1,e.$Message.error("请求失败")},complete:function(t,s){"timeout"==s&&(a.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})}}else this.unselectdrugmodel=!0}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"prescription-page"},[s("div",{staticClass:"content",attrs:{id:"content"}},[s("div",{staticClass:"item-wrapper"},[e._m(0),e._v(" "),s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[e._m(1),e._v(" "),s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.cardno,callback:function(t){e.$set(e.form,"cardno",t)},expression:"form.cardno"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[e._m(2),e._v(" "),s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.depname,callback:function(t){e.$set(e.form,"depname",t)},expression:"form.depname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[e._m(3),e._v(" "),s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.docname,callback:function(t){e.$set(e.form,"docname",t)},expression:"form.docname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[e._m(4),e._v(" "),s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.orderclass,callback:function(t){e.$set(e.form,"orderclass",t)},expression:"form.orderclass"}})],1),e._v(" "),s("div",{staticClass:"drug"},[s("div",{staticClass:"add-btn",on:{click:e.showdrugmodal}},[e._v("\n                请添加药品\n            ")]),e._v(" "),void 0==e.form.outs||e.form.outs.length<=0?s("div",{staticClass:"drug-tip"},[s("div",[e._v("\n                    请添加药品\n                ")])]):e._e(),e._v(" "),void 0!==e.form.outs&&e.form.outs.length>0?s("div",[s("div",{staticClass:"add-btn",on:{click:function(t){return e.editdrugdetail(-1)}}},[e._v("\n                    查看全部药品\n                ")]),e._v(" "),e._l(e.form.outs,function(t,i){return s("div",{key:i,staticClass:"item-wrapper",class:{active:e.styleindex==i}},[s("div",{staticClass:"drugname"},[e._v("\n                        "+e._s(t.drugName)+"  \n                    ")]),e._v(" "),s("div",{staticClass:"detaile",on:{click:function(t){return e.editdrugdetail(i)}}},[e._v("\n                        详情\n                    ")]),e._v(" "),s("div",{staticClass:"detaile",on:{click:function(t){return e.isdeletitem(i)}}},[e._v("\n                        删除\n                    ")])])})],2):e._e()])]),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},on:{touchstart:e.touchstart,touchend:e.touchend,click:e.toinsertprescribe}},[e._v("提交")])]),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"药品详情"},model:{value:e.isshowdrugs,callback:function(t){e.isshowdrugs=t},expression:"isshowdrugs"}},[s("div",{staticClass:"collapse-box"},e._l(e.form.outs,function(t,i){return s("div",{directives:[{name:"show",rawName:"v-show",value:e.currentdrugindex==i||e.isshowall,expression:"currentdrugindex==index||isshowall"}],key:i},[s("div",{staticClass:"drug-item",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"drugName"},[e._v(e._s(t.drugName)+"\n                    ")]),e._v(" "),s("div",{staticClass:"drugSpec"},[e._v("规格："+e._s(t.drugSpec))]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                                每次用量：\n                            ")]),e._v(" "),s("Input",{attrs:{type:"number"},on:{"on-change":function(s){return e.sumprice(t)},"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:t.dosAge,callback:function(s){e.$set(t,"dosAge",s)},expression:"item.dosAge"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                                "+e._s("盒"==t.dosAgeUnits?"":t.dosAgeUnits)+"\n                            ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                                用法：\n                            ")]),e._v(" "),s("Select",{attrs:{"label-in-value":""},model:{value:t.administretion,callback:function(s){e.$set(t,"administretion",s)},expression:"item.administretion"}},e._l(e.channel,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                                "+e._s("")+"\n                            ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[s("span",[e._v("\n                                    频次：\n                                ")])]),e._v(" "),s("Select",{attrs:{"label-in-value":""},on:{"on-change":function(s){return e.changefrequency(t)}},model:{value:t.frequency,callback:function(s){e.$set(t,"frequency",s)},expression:"item.frequency"}},e._l(e.frequency,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                                "+e._s("")+"\n                            ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                                数量：\n                            ")]),e._v(" "),s("Input",{attrs:{type:"number"},on:{"on-change":function(s){return e.sumprice(t)},"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:t.amount,callback:function(s){e.$set(t,"amount",s)},expression:"item.amount"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                                "+e._s(t.units)+"\n                            ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                                用药天数：\n                            ")]),e._v(" "),s("Input",{attrs:{type:"number",disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:t.abidance,callback:function(s){e.$set(t,"abidance",s)},expression:"item.abidance"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                                天\n                            ")])],1)]),e._v(" "),s("div",{staticClass:"drug-item-info"},[s("div",{staticClass:"drug-fun"},[s("span",{staticClass:"lititle"},[e._v("\n                                单价：\n                            ")]),e._v(" "),s("Input",{attrs:{type:"number",disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:t.price,callback:function(s){e.$set(t,"price",s)},expression:"item.price"}}),e._v(" "),s("span",{staticClass:"unit"},[e._v("\n                                元\n                            ")])],1)])])])}),0)]),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"选择药品"},model:{value:e.searchdrugmodal,callback:function(t){e.searchdrugmodal=t},expression:"searchdrugmodal"}},[s("div",{staticClass:"search-box-wrapper"},[s("div",{staticClass:"search-box"},[s("Input",{on:{"on-change":e.dealsearchDrug,"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.drugName,callback:function(t){e.drugName=t},expression:"drugName"}})],1),e._v(" "),void 0!==e.searchdruglist||e.searchdruglist.length>0?s("div",{staticClass:"search-yplist"},e._l(e.searchdruglist,function(t,i){return s("div",{key:i},[s("div",{staticClass:"search-ypnameitem ",on:{click:function(s){return e.adddrug(t)}}},[s("div",{staticClass:"ypname"},[e._v(e._s(t.ypname))]),e._v(" "),s("div",{staticClass:"ypinventory"},[e._v(e._s(t.inventory))])])])}),0):e._e(),e._v(" "),void 0===e.searchdruglist||e.searchdruglist.length<=0?s("div",{staticClass:"search-tip"},[e._v("\n                没有搜索到该药品\n            ")]):e._e()])]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":e.deletoutsitem},model:{value:e.isshowtip,callback:function(t){e.isshowtip=t},expression:"isshowtip"}},[e._v("\n        请正确填写信息\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.unselectdrugmodel,callback:function(t){e.unselectdrugmodel=t},expression:"unselectdrugmodel"}},[e._v("\n        请选择药品\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":e.insertprescribe},model:{value:e.isinsertprescribe,callback:function(t){e.isinsertprescribe=t},expression:"isinsertprescribe"}},[e._v("\n        请确认是否提交\n    ")]),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshowloading,expression:"isshowloading"}],staticClass:"loading"})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"title-tip"},[t("span",[this._v("患者姓名:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"title-tip"},[t("span",[this._v("患者卡号:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"title-tip"},[t("span",[this._v("就诊科室:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"title-tip"},[t("span",[this._v("就诊医生:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"title-tip"},[t("span",[this._v("医嘱类别:")])])}]};var o=s("VU/8")(a,r,!1,function(e){s("0kI5")},"data-v-1a4614f7",null);t.default=o.exports},JsLi:function(e,t){},MPwq:function(e,t){},MdCm:function(e,t){},NG4M:function(e,t,s){var i=s("oz9r"),n=s("krhF"),a=s("FVwl");function r(e,t){return new a(t).process(e)}for(var o in(t=e.exports=r).filterXSS=r,t.FilterXSS=a,i)t[o]=i[o];for(var o in n)t[o]=n[o];"undefined"!=typeof window&&(window.filterXSS=e.exports),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)},"Uo+f":function(e,t,s){var i=s("jCb9");e.exports=function(e,t){";"!==(e=i.trimRight(e))[e.length-1]&&(e+=";");var s=e.length,n=!1,a=0,r=0,o="";function c(){if(!n){var s=i.trim(e.slice(a,r)),c=s.indexOf(":");if(-1!==c){var l=i.trim(s.slice(0,c)),u=i.trim(s.slice(c+1));if(l){var d=t(a,o.length,l,u,s);d&&(o+=d+"; ")}}}a=r+1}for(;r<s;r++){var l=e[r];if("/"===l&&"*"===e[r+1]){var u=e.indexOf("*/",r+2);if(-1===u)break;a=(r=u+1)+1,n=!1}else"("===l?n=!0:")"===l?n=!1:";"===l?n||c():"\n"===l&&c()}return i.trim(o)}},YCsJ:function(e,t){},huvo:function(e,t,s){var i=s("/cOS"),n=s("Uo+f");s("jCb9");function a(e){return void 0===e||null===e}function r(e){(e=function(e){var t={};for(var s in e)t[s]=e[s];return t}(e||{})).whiteList=e.whiteList||i.whiteList,e.onAttr=e.onAttr||i.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||i.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||i.safeAttrValue,this.options=e}r.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,s=t.whiteList,i=t.onAttr,r=t.onIgnoreAttr,o=t.safeAttrValue;return n(e,function(e,t,n,c,l){var u=s[n],d=!1;if(!0===u?d=u:"function"==typeof u?d=u(c):u instanceof RegExp&&(d=u.test(c)),!0!==d&&(d=!1),c=o(n,c)){var m,p={position:t,sourcePosition:e,source:l,isWhite:d};return d?a(m=i(n,c,p))?n+":"+c:m:a(m=r(n,c,p))?void 0:m}})},e.exports=r},jCb9:function(e,t){e.exports={indexOf:function(e,t){var s,i;if(Array.prototype.indexOf)return e.indexOf(t);for(s=0,i=e.length;s<i;s++)if(e[s]===t)return s;return-1},forEach:function(e,t,s){var i,n;if(Array.prototype.forEach)return e.forEach(t,s);for(i=0,n=e.length;i<n;i++)t.call(s,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}},krhF:function(e,t,s){var i=s("noAI");function n(e){var t=i.spaceIndex(e);if(-1===t)var s=e.slice(1,-1);else s=e.slice(1,t+1);return"/"===(s=i.trim(s).toLowerCase()).slice(0,1)&&(s=s.slice(1)),"/"===s.slice(-1)&&(s=s.slice(0,-1)),s}function a(e){return"</"===e.slice(0,2)}var r=/[^a-zA-Z0-9_:\.\-]/gim;function o(e,t){for(;t<e.length;t++){var s=e[t];if(" "!==s)return"="===s?t:-1}}function c(e,t){for(;t>0;t--){var s=e[t];if(" "!==s)return"="===s?t:-1}}function l(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}t.parseTag=function(e,t,s){"user strict";var i="",r=0,o=!1,c=!1,l=0,u=e.length,d="",m="";for(l=0;l<u;l++){var p=e.charAt(l);if(!1===o){if("<"===p){o=l;continue}}else if(!1===c){if("<"===p){i+=s(e.slice(r,l)),o=l,r=l;continue}if(">"===p){i+=s(e.slice(r,o)),d=n(m=e.slice(o,l+1)),i+=t(o,i.length,d,m,a(m)),r=l+1,o=!1;continue}if(('"'===p||"'"===p)&&"="===e.charAt(l-1)){c=p;continue}}else if(p===c){c=!1;continue}}return r<e.length&&(i+=s(e.substr(r))),i},t.parseAttr=function(e,t){"user strict";var s=0,n=[],a=!1,u=e.length;function d(e,s){if(!((e=(e=i.trim(e)).replace(r,"").toLowerCase()).length<1)){var a=t(e,s||"");a&&n.push(a)}}for(var m=0;m<u;m++){var p,f=e.charAt(m);if(!1!==a||"="!==f)if(!1===a||m!==s||'"'!==f&&"'"!==f||"="!==e.charAt(m-1)){if(/\s|\n|\t/.test(f)){if(e=e.replace(/\s|\n|\t/g," "),!1===a){if(-1===(p=o(e,m))){d(i.trim(e.slice(s,m))),a=!1,s=m+1;continue}m=p-1;continue}if(-1===(p=c(e,m-1))){d(a,l(i.trim(e.slice(s,m)))),a=!1,s=m+1;continue}}}else{if(-1===(p=e.indexOf(f,m+1)))break;d(a,i.trim(e.slice(s+1,p))),a=!1,s=(m=p)+1}else a=e.slice(s,m),s=m+1}return s<e.length&&(!1===a?d(e.slice(s)):d(a,l(i.trim(e.slice(s))))),i.trim(n.join(" "))}},noAI:function(e,t){e.exports={indexOf:function(e,t){var s,i;if(Array.prototype.indexOf)return e.indexOf(t);for(s=0,i=e.length;s<i;s++)if(e[s]===t)return s;return-1},forEach:function(e,t,s){var i,n;if(Array.prototype.forEach)return e.forEach(t,s);for(i=0,n=e.length;i<n;i++)t.call(s,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}}},oz9r:function(e,t,s){var i=s("0Zbq").FilterCSS,n=s("0Zbq").getDefaultWhiteList,a=s("noAI");function r(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}var o=new i;function c(e){return e.replace(l,"&lt;").replace(u,"&gt;")}var l=/</g,u=/>/g,d=/"/g,m=/&quot;/g,p=/&#([a-zA-Z0-9]*);?/gim,f=/&colon;?/gim,v=/&newline;?/gim,h=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,g=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,y=/u\s*r\s*l\s*\(.*/gi;function b(e){return e.replace(d,"&quot;")}function w(e){return e.replace(m,'"')}function x(e){return e.replace(p,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function _(e){return e.replace(f,":").replace(v," ")}function k(e){for(var t="",s=0,i=e.length;s<i;s++)t+=e.charCodeAt(s)<32?" ":e.charAt(s);return a.trim(t)}function C(e){return e=k(e=_(e=x(e=w(e))))}function I(e){return e=c(e=b(e))}var $=/<!--[\s\S]*?-->/g;t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},t.getDefaultWhiteList=r,t.onTag=function(e,t,s){},t.onIgnoreTag=function(e,t,s){},t.onTagAttr=function(e,t,s){},t.onIgnoreTagAttr=function(e,t,s){},t.safeAttrValue=function(e,t,s,i){if(s=C(s),"href"===t||"src"===t){if("#"===(s=a.trim(s)))return"#";if("http://"!==s.substr(0,7)&&"https://"!==s.substr(0,8)&&"mailto:"!==s.substr(0,7)&&"tel:"!==s.substr(0,4)&&"#"!==s[0]&&"/"!==s[0])return""}else if("background"===t){if(h.lastIndex=0,h.test(s))return""}else if("style"===t){if(g.lastIndex=0,g.test(s))return"";if(y.lastIndex=0,y.test(s)&&(h.lastIndex=0,h.test(s)))return"";!1!==i&&(s=(i=i||o).process(s))}return s=I(s)},t.escapeHtml=c,t.escapeQuote=b,t.unescapeQuote=w,t.escapeHtmlEntities=x,t.escapeDangerHtml5Entities=_,t.clearNonPrintableCharacter=k,t.friendlyAttrValue=C,t.escapeAttrValue=I,t.onIgnoreTagStripAll=function(){return""},t.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var s=!Array.isArray(e),i=[],n=!1;return{onIgnoreTag:function(r,o,c){if(function(t){return!!s||-1!==a.indexOf(e,t)}(r)){if(c.isClosing){var l="[/removed]",u=c.position+l.length;return i.push([!1!==n?n:c.position,u]),n=!1,l}return n||(n=c.position),"[removed]"}return t(r,o,c)},remove:function(e){var t="",s=0;return a.forEach(i,function(i){t+=e.slice(s,i[0]),s=i[1]}),t+=e.slice(s)}}},t.stripCommentTag=function(e){return e.replace($,"")},t.stripBlankChar=function(e){var t=e.split("");return(t=t.filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})).join("")},t.cssFilter=o,t.getDefaultCSSWhiteList=n},sS1n:function(e,t){},tLa1:function(e,t){},"uXh+":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("vom9"),n=s("8pTZ"),a=s("CGhd"),r=s("//Fk"),o=s.n(r),c=s("Xxa5"),l=s.n(c),u=s("exGp"),d=s.n(u),m=s("mvHQ"),p=s.n(m),f=s("T4ej"),v=s("NG4M"),h=s.n(v),g={components:{loading:f.a},data:function(){return{infomsg:"",questmodel:!1,isshowcontent:!0,issubmitstate:!1,isshowloading:!1,ysrecordstate:1,btnvalue:"提交",modalcurrentvalue:"",currentvalue:"",isshowinput:!1,modal1:!1,inputsize:{minRows:8,maxRows:8},littleinputsize:{minRows:3,maxRows:3},opacity:1,value11:"",marry:"",form:{cardno:"",visitdate:"",visitno:" ",illnessdesc:"",anamnesis:"",familyall:"",marrital:"",individual:"",menses:"",medhistory:"",bodyexam:"",diagdesc:"",advice:"",doctor:"",ordinal:"1",operationrecord:"",medicalrecord:"",doctorno:"",memo:"",maternity:""},ruleValidate:{illnessdesc:[{type:"string",max:100,message:"主诉不能多于100个字",trigger:"change"}],anamnesis:[{type:"string",max:100,message:"既往史不能多于100个字",trigger:"change"}],maternity:[{type:"string",max:40,message:"婚孕史不能多于40个字",trigger:"change"}],marrital:[{type:"string",max:2,message:"婚姻不能多于2个字",trigger:"change"}],menses:[{type:"string",max:40,message:"月经史不能多于40个字",trigger:"change"}],individual:[{type:"string",max:40,message:"过敏史不能多于40个字",trigger:"change"}],familyall:[{type:"string",max:40,message:"主诉不能多于40个字",trigger:"change"}],medhistory:[{type:"string",max:1e3,message:"现病史不能多于1000个字",trigger:"change"}],operationrecord:[{type:"string",max:1e3,message:"处理不能多于1000个字",trigger:"change"}],bodyexam:[{type:"string",max:500,message:"主诉不能多于500个字",trigger:"change"}],medicalrecord:[{type:"string",max:1e3,message:"辅助检查不能多于1000个字",trigger:"change"}],diagdesc:[{type:"string",max:80,message:"诊断不能多于80个字",trigger:"change"}],advice:[{type:"string",max:80,message:"建议不能多于80个字",trigger:"change"}],memo:[{type:"string",max:80,message:"备注不能多于80个字",trigger:"change"}],doctor:[{type:"string",max:80,message:"备注不能多于80个字",trigger:"change"}]},patientinname:""}},methods:{issubmit:function(){this.issubmitstate=!0},changeisshowcontent:function(){this.isshowcontent=!0},showinput:function(e,t){this.isshowcontent=!1,this.focusstate=!1,this.isshowinput=!0,this.currentvalue=e,this.modalcurrentvalue=t},inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},topath:function(){this.$router.push("/registeredlist")},editinsert:function(e){var t=this;if(""!=e.diagdesc){var s=t.$store.getters.getUrl+"medicalrecord/updatemedicalrecord.do";t.isshowloading=!0;e.cardno;$.ajax({url:s,type:"post",dataType:"json",async:!1,data:{cardno:h()(e.cardno),visitno:e.visitno,illnessdesc:e.illnessdesc,anamnesis:e.anamnesis,familyall:e.familyall,marrital:e.marrital,individual:e.individual,menses:e.menses,medhistory:e.medhistory,bodyexam:e.bodyexam,diagdesc:e.diagdesc,advice:e.advice,operationrecord:e.operationrecord,medicalrecord:e.medicalrecord,memo:e.memo,maternity:e.maternity},success:function(e){t.isshowloading=!1,"1"==e.status?(t.$Message.info("修改成功！"),window.websocketobj.send(p()({cardno:t.form.cardno,massege:"123"}))):(t.questmodel=!0,t.infomsg="修改病历失败！")},error:function(e){t.isshowloading=!1,t.questmodel=!0,t.infomsg="请求发送失败失败！"}})}else this.modal1=!0},insert:function(e){var t=this,s=t.$store.getters.getUrl+"medicalrecord/insertmedicalrecord.do";if(""!=e.diagdesc){this.isshowloading=!0;e.cardno;var i={cardno:e.cardno,visitdate:e.visitdate,visitno:e.visitno,illnessdesc:e.illnessdesc,anamnesis:e.anamnesis,familyall:e.familyall,marrital:e.marrital,individual:e.individual,menses:e.menses,medhistory:e.medhistory,bodyexam:e.bodyexam,diagdesc:e.diagdesc,advice:e.advice,doctor:e.doctor,ordinal:"1",operationrecord:e.operationrecord,medicalrecord:e.medicalrecord,doctorno:e.doctor,memo:e.memo,maternity:e.maternity};$.ajax({url:s,type:"post",dataType:"json",async:!1,contentType:"application/json",data:p()(i),success:function(e){t.isshowloading=!1,"1"==e.status?(t.$Message.info("病历提交成功"),localStorage.setItem("ysrecordstate",5),t.ysrecordstate=5,window.websocketobj.send(p()({cardno:t.form.cardno,massege:"123"}))):(t.questmodel=!0,t.infomsg="病历提交失败！")},error:function(e){t.isshowloading=!1,t.questmodel=!0,t.infomsg="请求发送失败失败！"}})}else this.modal1=!0},submit:function(e){var t=this;this.issubmitstate=!1;var s=new Date,i=s.getFullYear(),n=s.getMonth()+1,a=s.getDate();n<10&&(n="0"+n),a<10&&(a="0"+a),this.form.visitdate=i+"-"+n+"-"+a,this.$refs[e].validate(function(e){e&&(1==localStorage.getItem("ysrecordstate")?t.insert(t.form):t.editinsert(t.form))})},unrecord:function(){var e=this;return d()(l.a.mark(function t(){var s,i,n,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e,i=JSON.parse(localStorage.getItem("yspatientinfo")),e.form.docName=i.hosdocname,e.form.doctorno=i.doctor,e.form.doctor=i.hosdocname,t.next=7,e.fetchMegetMedicalLast();case 7:"1"==(n=t.sent).status?((a=n.data[0]).medhistory?e.form.medhistory=a.medhistory:e.form.medhistory="",a.anamnesis?e.form.anamnesis=a.anamnesis:e.form.anamnesis="",a.individual?e.form.individual=a.individual:e.form.individual="",a.menses?e.form.menses=a.menses:e.form.menses="",a.familyill?e.form.familyall=a.familyill:e.form.familyall=""):5==n.status?(s.questmodel=!0,s.infomsg="请求发送失败"):"0"==n.status||(s.questmodel=!0,s.infomsg="获取病史系统异常");case 9:case"end":return t.stop()}},t,e)}))()},getcurrentdayrecord:function(){var e=this,t=JSON.parse(localStorage.getItem("yspatientinfo")),s=t.patientid,i=t.visitno,n=new Date,a=n.getFullYear(),r=n.getMonth()+1,o=n.getDate();r<10&&(r="0"+r),o<10&&(o="0"+o);var c=a+"-"+r+"-"+o,l=t.doctor,u=e.$store.getters.getUrl+"medicalrecord/getthesamedayoutpmr.do",d=$.ajax({url:u,type:"post",dataType:"json",timeout:15e3,async:!0,data:{patientid:s,visitdate:c,doccode:l,visitno:i},success:function(t){if(e.isshowloading=!1,"1"==t.status){e.ysrecordstate=5,localStorage.setItem("ysrecordstate",5);var s=t.data[0];for(var i in s)for(var n in e.form)i==n?e.form[n]=s[i]:"maternitl"==i?e.form.maternity=s.maternitl:"familyill"==i?e.form.familyall=s.familyill:"openrationrecord"==i?e.form.operationrecord=s.openrationrecord:"bodymeax"==i&&(e.form.bodyexam=s.bodymeax)}else"0"==t.status?(e.ysrecordstate=1,localStorage.setItem("ysrecordstate",1),e.unrecord()):-1==t.status?e.$router.push("/abnormal"):(e.infomsg="病历获取系统异常",e.questmodel=!0)},error:function(t){e.isshowloading=!1,e.infomsg="请求发送失败",e.questmodel=!0},complete:function(t,s){"timeout"==s&&(d.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},fetchMegetMedicalLast:function(){var e=this;return new o.a(function(t,s){var i=e,n=JSON.parse(localStorage.getItem("yspatientinfo")).patientid,a=i.$store.getters.getUrl+"medicalrecord/MegetMedicalLast.do";i.isshowloading=!0;var r=$.ajax({url:a,type:"post",dataType:"json",async:!0,timeout:15e3,data:{cardno:n},success:function(e){i.isshowloading=!1,t(e)},error:function(e){i.isshowloading=!1;t({status:5})},complete:function(e,t){"timeout"==t&&(r.abort(),i.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},init:function(){var e=this;return d()(l.a.mark(function t(){var s,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s=localStorage.getItem("yspatientinfo"),i=JSON.parse(s),e.patientinname=i.name,e.form.cardno=i.patientid,e.form.visitno=i.visitno,e.getcurrentdayrecord();case 6:case"end":return t.stop()}},t,e)}))()}},mounted:function(){var e=this;setTimeout(function(){e.init()},10)}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"writecheck-page"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isshowcontent,expression:"isshowcontent"}],staticClass:"content"},[s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                患者姓名:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},model:{value:e.patientinname,callback:function(t){e.patientinname=t},expression:"patientinname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("illnessdesc","主诉")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                主诉:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.illnessdesc,callback:function(t){e.$set(e.form,"illnessdesc",t)},expression:"form.illnessdesc"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("anamnesis","既往史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                既往史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.anamnesis,callback:function(t){e.$set(e.form,"anamnesis",t)},expression:"form.anamnesis"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("maternity","婚孕史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                婚孕史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.maternity,callback:function(t){e.$set(e.form,"maternity",t)},expression:"form.maternity"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("menses","月经史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                月经史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.menses,callback:function(t){e.$set(e.form,"menses",t)},expression:"form.menses"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("individual","过敏史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                过敏史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",staticStyle:{border:"none"},attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.individual,callback:function(t){e.$set(e.form,"individual",t)},expression:"form.individual"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("familyall","家族史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                家族史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.familyall,callback:function(t){e.$set(e.form,"familyall",t)},expression:"form.familyall"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("medhistory","现病史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                现病史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medhistory,callback:function(t){e.$set(e.form,"medhistory",t)},expression:"form.medhistory"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("operationrecord","处理")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                处理:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.operationrecord,callback:function(t){e.$set(e.form,"operationrecord",t)},expression:"form.operationrecord"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("diagdesc","诊断")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                诊断:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.diagdesc,callback:function(t){e.$set(e.form,"diagdesc",t)},expression:"form.diagdesc"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("memo","备注")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                备注:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1)]),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},on:{touchstart:e.touchstart,touchend:e.touchend,click:function(t){return e.issubmit("formValidate")}}},[e._v("\n            "+e._s(1==e.ysrecordstate?"提交":"修改病历")+"\n        ")])]),e._v(" "),s("Modal",{attrs:{title:e.modalcurrentvalue,closable:!1,fullscreen:""},on:{"on-ok":e.changeisshowcontent,"on-cancel":e.changeisshowcontent},model:{value:e.isshowinput,callback:function(t){e.isshowinput=t},expression:"isshowinput"}},[s("Form",{ref:"formValidate",attrs:{model:e.form,rules:e.ruleValidate}},[s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"patientinname"==e.currentvalue,expression:"currentvalue=='patientinname'"}],attrs:{prop:"patientinname"}},[s("Input",{attrs:{disabled:""},model:{value:e.patientinname,callback:function(t){e.patientinname=t},expression:"patientinname"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"illnessdesc"==e.currentvalue,expression:"currentvalue=='illnessdesc'"}],attrs:{prop:"illnessdesc"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.illnessdesc,callback:function(t){e.$set(e.form,"illnessdesc",t)},expression:"form.illnessdesc"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"anamnesis"==e.currentvalue,expression:"currentvalue=='anamnesis'"}],attrs:{prop:"anamnesis"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.anamnesis,callback:function(t){e.$set(e.form,"anamnesis",t)},expression:"form.anamnesis"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"maternity"==e.currentvalue,expression:"currentvalue=='maternity'"}],attrs:{prop:"maternity"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.maternity,callback:function(t){e.$set(e.form,"maternity",t)},expression:"form.maternity"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"marrital"==e.currentvalue,expression:"currentvalue=='marrital'"}],attrs:{prop:"marrital"}},[s("Select",{model:{value:e.form.marrital,callback:function(t){e.$set(e.form,"marrital",t)},expression:"form.marrital"}},[s("Option",{attrs:{value:"已婚"}},[e._v("已婚")]),e._v(" "),s("Option",{attrs:{value:"未婚"}},[e._v("未婚")])],1)],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"menses"==e.currentvalue,expression:"currentvalue=='menses'"}],attrs:{prop:"menses"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.menses,callback:function(t){e.$set(e.form,"menses",t)},expression:"form.menses"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"individual"==e.currentvalue,expression:"currentvalue=='individual'"}],attrs:{prop:"individual"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.individual,callback:function(t){e.$set(e.form,"individual",t)},expression:"form.individual"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"familyall"==e.currentvalue,expression:"currentvalue=='familyall'"}],attrs:{prop:"familyall"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.familyall,callback:function(t){e.$set(e.form,"familyall",t)},expression:"form.familyall"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"medhistory"==e.currentvalue,expression:"currentvalue=='medhistory'"}],attrs:{prop:"medhistory"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medhistory,callback:function(t){e.$set(e.form,"medhistory",t)},expression:"form.medhistory"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"operationrecord"==e.currentvalue,expression:"currentvalue=='operationrecord'"}],attrs:{prop:"operationrecord"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.operationrecord,callback:function(t){e.$set(e.form,"operationrecord",t)},expression:"form.operationrecord"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"bodyexam"==e.currentvalue,expression:"currentvalue=='bodyexam'"}],attrs:{prop:"bodyexam"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.bodyexam,callback:function(t){e.$set(e.form,"bodyexam",t)},expression:"form.bodyexam"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"medicalrecord"==e.currentvalue,expression:"currentvalue=='medicalrecord'"}],attrs:{prop:"medicalrecord"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medicalrecord,callback:function(t){e.$set(e.form,"medicalrecord",t)},expression:"form.medicalrecord"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"diagdesc"==e.currentvalue,expression:"currentvalue=='diagdesc'"}],attrs:{prop:"diagdesc"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.diagdesc,callback:function(t){e.$set(e.form,"diagdesc",t)},expression:"form.diagdesc"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"advice"==e.currentvalue,expression:"currentvalue=='advice'"}],attrs:{prop:"advice"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.advice,callback:function(t){e.$set(e.form,"advice",t)},expression:"form.advice"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"memo"==e.currentvalue,expression:"currentvalue=='memo'"}],attrs:{prop:"memo"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"doctor"==e.currentvalue,expression:"currentvalue=='doctor'"}],attrs:{prop:"doctor"}},[s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.doctor,callback:function(t){e.$set(e.form,"doctor",t)},expression:"form.doctor"}})],1)],1)],1),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.questmodel,callback:function(t){e.questmodel=t},expression:"questmodel"}},[e._v("\n        "+e._s(e.infomsg)+"\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[e._v("\n        请填写诊断！\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":function(t){return e.submit("formValidate")}},model:{value:e.issubmitstate,callback:function(t){e.issubmitstate=t},expression:"issubmitstate"}},[e._v("\n        请确认是否提交！\n    ")]),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshowloading,expression:"isshowloading"}]})],1)},staticRenderFns:[]};var b=s("VU/8")(g,y,!1,function(e){s("+JLr")},"data-v-4995a248",null).exports,w={components:{loading:f.a},data:function(){return{questmodel:!1,infomsg:"",isshowcontent:!0,issubmitstate:!1,isshowloading:!1,ysrecordstate:1,btnvalue:"提交",modalcurrentvalue:"",currentvalue:"",isshowinput:!1,modal1:!1,inputsize:{minRows:8,maxRows:8},littleinputsize:{minRows:3,maxRows:3},opacity:1,value11:"",marry:"",form:{cardno:"",visitdate:"",visitno:" ",illnessdesc:"",anamnesis:"",familyall:"",marrital:"",individual:"",menses:"",medhistory:"",bodyexam:"",diagdesc:"",advice:"",doctor:"",ordinal:"1",operationrecord:"",medicalrecord:"",doctorno:"",memo:"",maternity:""},ruleValidate:{illnessdesc:[{type:"string",max:100,message:"主诉不能多于100个字",trigger:"change"}],anamnesis:[{type:"string",max:100,message:"既往史不能多于100个字",trigger:"change"}],maternity:[{type:"string",max:40,message:"婚孕史不能多于40个字",trigger:"change"}],marrital:[{type:"string",max:2,message:"婚姻不能多于2个字",trigger:"change"}],menses:[{type:"string",max:40,message:"月经史不能多于40个字",trigger:"change"}],individual:[{type:"string",max:40,message:"过敏史不能多于40个字",trigger:"change"}],familyall:[{type:"string",max:40,message:"主诉不能多于40个字",trigger:"change"}],medhistory:[{type:"string",max:1e3,message:"现病史不能多于1000个字",trigger:"change"}],operationrecord:[{type:"string",max:1e3,message:"处理不能多于1000个字",trigger:"change"}],bodyexam:[{type:"string",max:500,message:"主诉不能多于500个字",trigger:"change"}],medicalrecord:[{type:"string",max:1e3,message:"辅助检查不能多于1000个字",trigger:"change"}],diagdesc:[{type:"string",max:80,message:"诊断不能多于80个字",trigger:"change"}],advice:[{type:"string",max:80,message:"建议不能多于80个字",trigger:"change"}],memo:[{type:"string",max:80,message:"备注不能多于80个字",trigger:"change"}],doctor:[{type:"string",max:80,message:"备注不能多于80个字",trigger:"change"}]},patientinname:""}},methods:{issubmit:function(){this.issubmitstate=!0},changeisshowcontent:function(){this.isshowcontent=!0},showinput:function(e,t){this.isshowcontent=!1,this.focusstate=!1,this.isshowinput=!0,this.currentvalue=e,this.modalcurrentvalue=t},inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},topath:function(){this.$router.push("/registeredlist")},editinsert:function(e){var t=this;if(""!=e.diagdesc){var s=t.$store.getters.getUrl+"medicalrecord/updatemedicalrecord.do";t.isshowloading=!0;e.cardno;t.isshowloading=!0,$.ajax({url:s,type:"post",dataType:"json",async:!1,data:{cardno:h()(e.cardno),visitno:e.visitno,illnessdesc:e.illnessdesc,anamnesis:e.anamnesis,familyall:e.familyall,marrital:e.marrital,individual:e.individual,menses:e.menses,medhistory:e.medhistory,bodyexam:e.bodyexam,diagdesc:e.diagdesc,advice:e.advice,operationrecord:e.operationrecord,medicalrecord:e.medicalrecord,memo:e.memo,maternity:e.maternity},success:function(e){t.isshowloading=!1,"1"==e.status?(t.$Message.info("修改成功！"),window.websocketobj.send(p()({cardno:t.form.cardno,massege:"123"}))):(t.infomsg="病历修改失败",t.questmodel=!0)},error:function(e){t.isshowloading=!1,t.infomsg="请求发送失败",t.questmodel=!0}})}else this.modal1=!0},insert:function(e){var t=this,s=t.$store.getters.getUrl+"medicalrecord/insertmedicalrecord.do";if(""!=e.diagdesc){this.isshowloading=!0;e.cardno;var i={cardno:e.cardno,visitdate:e.visitdate,visitno:e.visitno,illnessdesc:e.illnessdesc,anamnesis:e.anamnesis,familyall:e.familyall,marrital:e.marrital,individual:e.individual,menses:e.menses,medhistory:e.medhistory,bodyexam:e.bodyexam,diagdesc:e.diagdesc,advice:e.advice,doctor:e.doctor,ordinal:"1",operationrecord:e.operationrecord,medicalrecord:e.medicalrecord,doctorno:e.doctorno,memo:e.memo,maternity:e.maternity};$.ajax({url:s,type:"post",dataType:"json",async:!1,contentType:"application/json",data:p()(i),success:function(e){t.isshowloading=!1,"1"==e.status?(t.$Message.info("病历提交成功"),localStorage.setItem("ysrecordstate",5),t.ysrecordstate=5,window.websocketobj.send(p()({cardno:t.form.cardno,massege:"123"}))):(t.infomsg="病历提交失败",t.questmodel=!0)},error:function(e){t.isshowloading=!1,t.infomsg="请求发送失败",t.questmodel=!0}})}else this.modal1=!0},submit:function(e){var t=this;this.issubmitstate=!1;var s=new Date,i=s.getFullYear(),n=s.getMonth()+1,a=s.getDate();n<10&&(n="0"+n),a<10&&(a="0"+a),this.form.visitdate=i+"-"+n+"-"+a,this.$refs[e].validate(function(e){e&&(1==localStorage.getItem("ysrecordstate")?t.insert(t.form):t.editinsert(t.form))})},unrecord:function(){var e=this;return d()(l.a.mark(function t(){var s,i,n,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e,i=JSON.parse(localStorage.getItem("yspatientinfo")),e.form.docName=i.hosdocname,e.form.doctorno=i.doctor,e.form.doctor=i.hosdocname,t.next=7,e.fetchMegetMedicalLast();case 7:"1"==(n=t.sent).status?((a=n.data[0]).medhistory?e.form.medhistory=a.medhistory:e.form.medhistory="",a.anamnesis?e.form.anamnesis=a.anamnesis:e.form.anamnesis="",a.individual?e.form.individual=a.individual:e.form.individual="",a.menses?e.form.menses=a.menses:e.form.menses="",a.familyill?e.form.familyall=a.familyill:e.form.familyall=""):5==n.status?(s.questmodel=!0,s.infomsg="请求发送失败"):"0"==n.status||(s.questmodel=!0,s.infomsg="获取病史系统异常");case 9:case"end":return t.stop()}},t,e)}))()},getcurrentdayrecord:function(){var e=this,t=JSON.parse(localStorage.getItem("yspatientinfo")),s=t.patientid,i=t.visitno,n=new Date,a=n.getFullYear(),r=n.getMonth()+1,o=n.getDate();r<10&&(r="0"+r),o<10&&(o="0"+o);var c=a+"-"+r+"-"+o,l=t.doctor;e.isshowloading=!0;var u=e.$store.getters.getUrl+"medicalrecord/getthesamedayoutpmr.do",d=$.ajax({url:u,type:"post",dataType:"json",timeout:15e3,async:!0,data:{patientid:s,visitdate:c,doccode:l,visitno:i},success:function(t){if(e.isshowloading=!1,"1"==t.status){e.ysrecordstate=5,localStorage.setItem("ysrecordstate",5);var s=t.data[0];for(var i in s)for(var n in e.form)i==n?e.form[n]=s[i]:"maternitl"==i?e.form.maternity=s.maternitl:"familyill"==i?e.form.familyall=s.familyill:"openrationrecord"==i?e.form.operationrecord=s.openrationrecord:"bodymeax"==i&&(e.form.bodyexam=s.bodymeax)}else"0"==t.status?(e.ysrecordstate=1,localStorage.setItem("ysrecordstate",1),e.unrecord()):-1==t.status?e.$router.push("/abnormal"):(e.infomsg="病历获取系统异常",e.questmodel=!0)},error:function(t){e.isshowloading=!1,e.infomsg="请求发送失败",e.questmodel=!0},complete:function(t,s){"timeout"==s&&(d.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},fetchMegetMedicalLast:function(){var e=this;return new o.a(function(t,s){var i=e,n=JSON.parse(localStorage.getItem("yspatientinfo")).patientid,a=i.$store.getters.getUrl+"medicalrecord/MegetMedicalLast.do",r=$.ajax({url:a,type:"post",dataType:"json",timeout:15e3,async:!0,data:{cardno:n},success:function(e){this.isshowloading=!1,t(e)},error:function(e){this.isshowloading=!1;t({status:5})},complete:function(e,t){"timeout"==t&&(r.abort(),i.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},init:function(){var e=this;return d()(l.a.mark(function t(){var s,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e,e.ysrecordstate=localStorage.getItem("ysrecordstate"),e.ysrecordstate,s=localStorage.getItem("yspatientinfo"),i=JSON.parse(s),e.patientinname=i.name,e.form.cardno=i.patientid,e.form.visitno=i.visitno,e.getcurrentdayrecord();case 9:case"end":return t.stop()}},t,e)}))()}},mounted:function(){var e=this;setTimeout(function(){e.init()},10)}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"writecheck-page"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isshowcontent,expression:"isshowcontent"}],staticClass:"content"},[s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                患者姓名:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},model:{value:e.patientinname,callback:function(t){e.patientinname=t},expression:"patientinname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("illnessdesc","主诉")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                主诉:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.illnessdesc,callback:function(t){e.$set(e.form,"illnessdesc",t)},expression:"form.illnessdesc"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("anamnesis","既往史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                既往史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.anamnesis,callback:function(t){e.$set(e.form,"anamnesis",t)},expression:"form.anamnesis"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("individual","过敏史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                过敏史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",staticStyle:{border:"none"},attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.individual,callback:function(t){e.$set(e.form,"individual",t)},expression:"form.individual"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("familyall","家族史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                家族史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.familyall,callback:function(t){e.$set(e.form,"familyall",t)},expression:"form.familyall"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("medhistory","现病史")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                现病史:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medhistory,callback:function(t){e.$set(e.form,"medhistory",t)},expression:"form.medhistory"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("operationrecord","处理")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                处理:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.operationrecord,callback:function(t){e.$set(e.form,"operationrecord",t)},expression:"form.operationrecord"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("diagdesc","诊断")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                诊断:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.diagdesc,callback:function(t){e.$set(e.form,"diagdesc",t)},expression:"form.diagdesc"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper",on:{click:function(t){return e.showinput("memo","备注")}}},[s("div",{staticClass:"title-tip"},[e._v("\n                备注:\n            ")]),e._v(" "),s("Input",{staticClass:"input",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1)]),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},on:{touchstart:e.touchstart,touchend:e.touchend,click:function(t){return e.issubmit("formValidate")}}},[e._v("\n            "+e._s(1==e.ysrecordstate?"提交":"修改病历")+"\n        ")])]),e._v(" "),s("Modal",{attrs:{title:e.modalcurrentvalue,closable:!1,fullscreen:""},on:{"on-ok":e.changeisshowcontent,"on-cancel":e.changeisshowcontent},model:{value:e.isshowinput,callback:function(t){e.isshowinput=t},expression:"isshowinput"}},[s("Form",{ref:"formValidate",attrs:{model:e.form,rules:e.ruleValidate}},[s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"patientinname"==e.currentvalue,expression:"currentvalue=='patientinname'"}],attrs:{prop:"patientinname"}},[s("Input",{attrs:{disabled:""},model:{value:e.patientinname,callback:function(t){e.patientinname=t},expression:"patientinname"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"illnessdesc"==e.currentvalue,expression:"currentvalue=='illnessdesc'"}],attrs:{prop:"illnessdesc"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.illnessdesc,callback:function(t){e.$set(e.form,"illnessdesc",t)},expression:"form.illnessdesc"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"anamnesis"==e.currentvalue,expression:"currentvalue=='anamnesis'"}],attrs:{prop:"anamnesis"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.anamnesis,callback:function(t){e.$set(e.form,"anamnesis",t)},expression:"form.anamnesis"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"maternity"==e.currentvalue,expression:"currentvalue=='maternity'"}],attrs:{prop:"maternity"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.maternity,callback:function(t){e.$set(e.form,"maternity",t)},expression:"form.maternity"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"marrital"==e.currentvalue,expression:"currentvalue=='marrital'"}],attrs:{prop:"marrital"}},[s("Select",{model:{value:e.form.marrital,callback:function(t){e.$set(e.form,"marrital",t)},expression:"form.marrital"}},[s("Option",{attrs:{value:"已婚"}},[e._v("已婚")]),e._v(" "),s("Option",{attrs:{value:"未婚"}},[e._v("未婚")])],1)],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"menses"==e.currentvalue,expression:"currentvalue=='menses'"}],attrs:{prop:"menses"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.menses,callback:function(t){e.$set(e.form,"menses",t)},expression:"form.menses"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"individual"==e.currentvalue,expression:"currentvalue=='individual'"}],attrs:{prop:"individual"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.individual,callback:function(t){e.$set(e.form,"individual",t)},expression:"form.individual"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"familyall"==e.currentvalue,expression:"currentvalue=='familyall'"}],attrs:{prop:"familyall"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.familyall,callback:function(t){e.$set(e.form,"familyall",t)},expression:"form.familyall"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"medhistory"==e.currentvalue,expression:"currentvalue=='medhistory'"}],attrs:{prop:"medhistory"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medhistory,callback:function(t){e.$set(e.form,"medhistory",t)},expression:"form.medhistory"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"operationrecord"==e.currentvalue,expression:"currentvalue=='operationrecord'"}],attrs:{prop:"operationrecord"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.operationrecord,callback:function(t){e.$set(e.form,"operationrecord",t)},expression:"form.operationrecord"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"bodyexam"==e.currentvalue,expression:"currentvalue=='bodyexam'"}],attrs:{prop:"bodyexam"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.bodyexam,callback:function(t){e.$set(e.form,"bodyexam",t)},expression:"form.bodyexam"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"medicalrecord"==e.currentvalue,expression:"currentvalue=='medicalrecord'"}],attrs:{prop:"medicalrecord"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.medicalrecord,callback:function(t){e.$set(e.form,"medicalrecord",t)},expression:"form.medicalrecord"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"diagdesc"==e.currentvalue,expression:"currentvalue=='diagdesc'"}],attrs:{prop:"diagdesc"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.diagdesc,callback:function(t){e.$set(e.form,"diagdesc",t)},expression:"form.diagdesc"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"advice"==e.currentvalue,expression:"currentvalue=='advice'"}],attrs:{prop:"advice"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.advice,callback:function(t){e.$set(e.form,"advice",t)},expression:"form.advice"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"memo"==e.currentvalue,expression:"currentvalue=='memo'"}],attrs:{prop:"memo"}},[s("Input",{attrs:{type:"textarea",autosize:e.inputsize},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),e._v(" "),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:"doctor"==e.currentvalue,expression:"currentvalue=='doctor'"}],attrs:{prop:"doctor"}},[s("Input",{attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.doctor,callback:function(t){e.$set(e.form,"doctor",t)},expression:"form.doctor"}})],1)],1)],1),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[e._v("\n        请填写诊断！\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":function(t){return e.submit("formValidate")}},model:{value:e.issubmitstate,callback:function(t){e.issubmitstate=t},expression:"issubmitstate"}},[e._v("\n        请确认是否提交！\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.questmodel,callback:function(t){e.questmodel=t},expression:"questmodel"}},[e._v("\n        "+e._s(e.infomsg)+"\n    ")]),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshowloading,expression:"isshowloading"}]})],1)},staticRenderFns:[]};var _=s("VU/8")(w,x,!1,function(e){s("MPwq")},"data-v-5c80ebd2",null).exports,k=s("Gg9O"),C=s("0hsi"),I=s("Vz6l"),j=s("uGJ5"),q={name:"detail",components:{writecheck:i.default,writingtest:n.default,writerecords:a.default,prescription:k.default,zhprescription:C.default,writerecordsobs:b,writerecordschild:_},data:function(){return{value6:"",currentindex:0,drugstate:"west",drugindex:0,cardno:"",name:"",type:"-1"}},methods:{tobackdetail:function(){this.$router.push("/registeredlist")},record:function(e){1!=localStorage.getItem("ysrecordstate")&&this.currentindex!=e&&(this.currentindex=e)},changeradio:function(e){var t=void 0;t="west"==e?0:1,this.drugindex!=t&&(this.drugindex=t)},tomedicalrecords:function(){localStorage.setItem("tiao",1),this.$router.push("/doctorckeck")}},mounted:function(){var e=this.$store.getters.getUrl+"SweepCode.do";Object(j.a)(e);var t=localStorage.getItem("yspatientinfo"),s=JSON.parse(t);this.name=s.name,"10010201"==s.registerdept||"10010202"==s.registerdept||"10010203"==s.registerdept||"10010209"==s.registerdept?this.type="2":"10010301"==s.registerdept?this.type="3":this.type="1",this.cardno=s.patientid,Object(I.a)(localStorage.getItem("ysdoccode"))},destroyed:function(){window.websocketobj.close(),delete window.websocketobj}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"detail-list"},[s("div",{staticClass:"title"},[s("div",{staticClass:"arrow-icon",on:{click:e.tobackdetail}},[s("Icon",{attrs:{size:"30",type:"ios-arrow-back"}})],1),e._v(" "),e._v("\n        滦平县妇幼保健院\n    ")]),e._v(" "),s("div",{staticClass:"doctor-info"},[e._m(0),e._v(" "),s("div",{staticClass:"info"},[s("div",[e._v("患者姓名："+e._s(e.name)+" ")]),e._v(" "),s("div",[e._v("患者卡号："+e._s(e.cardno))])]),e._v(" "),s("div",{staticClass:"icon-arrow",on:{click:e.tomedicalrecords}},[s("Icon",{attrs:{size:"50",color:"rgb(0,187,187)",type:"ios-arrow-dropright"}})],1)]),e._v(" "),s("div",{staticClass:"main-box"},[0==e.currentindex?s("div",{staticClass:"left"},["1"==e.type?s("writerecords"):e._e(),e._v(" "),"2"==e.type?s("writerecordsobs"):e._e(),e._v(" "),"3"==e.type?s("writerecordschild"):e._e()],1):e._e(),e._v(" "),1==e.currentindex?s("div",{staticClass:"left"},[s("writecheck")],1):e._e(),e._v(" "),2==e.currentindex?s("div",{staticClass:"left"},[s("writingtest")],1):e._e(),e._v(" "),3==e.currentindex?s("div",{ref:"scrollitem",staticClass:"left",attrs:{id:"left"}},[s("div",{staticClass:"input-wrapper"},[s("RadioGroup",{on:{"on-change":e.changeradio},model:{value:e.drugstate,callback:function(t){e.drugstate=t},expression:"drugstate"}},[s("Radio",{attrs:{label:"east"}},[s("span",[e._v("中药")])]),e._v(" "),s("Radio",{attrs:{label:"west"}},[s("span",[e._v("西药")])])],1)],1),e._v(" "),0==e.drugindex?s("div",[s("prescription",{ref:"prescription"})],1):e._e(),e._v(" "),1==e.drugindex?s("div",[s("zhprescription",{ref:"zhprescription"})],1):e._e()]):e._e(),e._v(" "),4==e.currentindex?s("div",{staticClass:"left"},[s("p",{staticClass:"tipinfo"},[e._v("暂无住院信息！")])]):e._e(),e._v(" "),5==e.currentindex?s("div",{staticClass:"left"},[s("p",{staticClass:"tipinfo"},[e._v("暂无治疗信息！")])]):e._e(),e._v(" "),s("div",{staticClass:"right"},[s("div",[s("div",{staticClass:"btn",class:{active:0==e.currentindex},on:{click:function(t){return e.record(0)}}},[s("p",[e._v("病")]),e._v(" "),s("p",[e._v("历")])]),e._v(" "),s("div",{staticClass:"btn",class:{active:1==e.currentindex},on:{click:function(t){return e.record(1)}}},[s("p",[e._v("检")]),e._v(" "),s("p",[e._v("查")])]),e._v(" "),s("div",{staticClass:"btn",class:{active:2==e.currentindex},on:{click:function(t){return e.record(2)}}},[s("p",[e._v("化")]),e._v(" "),s("p",[e._v("验")])]),e._v(" "),s("div",{staticClass:"btn",class:{active:3==e.currentindex},on:{click:function(t){return e.record(3)}}},[s("p",[e._v("处")]),e._v(" "),s("p",[e._v("方")])]),e._v(" "),s("div",{staticClass:"btn",class:{active:5==e.currentindex},on:{click:function(t){return e.record(5)}}},[s("p",[e._v("治")]),e._v(" "),s("p",[e._v("疗")])]),e._v(" "),s("div",{staticClass:"btn",class:{active:4==e.currentindex},on:{click:function(t){return e.record(4)}}},[s("p",[e._v("住")]),e._v(" "),s("p",[e._v("院")])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"avatar"},[t("img",{attrs:{src:s("HfaK"),alt:""}})])}]};var S=s("VU/8")(q,F,!1,function(e){s("JsLi")},"data-v-2dc7bd84",null);t.default=S.exports},vom9:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Xxa5"),n=s.n(i),a=s("exGp"),r=s.n(a),o=s("//Fk"),c=s.n(o),l=s("mvHQ"),u=s.n(l),d=s("bOdI"),m=s.n(d),p={components:{loading:s("T4ej").a},data:function(){var e;return e={infomsg:"",requestmodel:!1,testlist:[],skyvalue:"",isshowsubclass:!1,modal3:!1,issubmit:!1,projectmodel:!1,isshow:!1,modal1:!1,ishownullmodel:"",opacity:""},m()(e,"opacity",1),m()(e,"inputsize",{minRows:6,maxRows:6}),m()(e,"visitdate",""),m()(e,"depname",""),m()(e,"position",""),m()(e,"form",{cardno:"",examsubclass:"",examclass:"",clindiag:"",performedby:"",patientsource:"1",reqdatetime:"",reqdept:"",reqphysician:"",doctoruser:"",descriptioncode:"",projectname:"",clinicno:"",visitno:""}),m()(e,"projectname",[]),m()(e,"checklist",[]),m()(e,"dealchecklist",[]),m()(e,"subchecklist",[]),m()(e,"dealsubchecklist",[]),m()(e,"projectnamelist",[]),m()(e,"dealprojectnamelist",[]),e},methods:{showmodel:function(){this.projectmodel=!0},inputLoseFocus:function(){setTimeout(function(){window.scrollTo(0,0)},100)},touchstart:function(){this.opacity=.5},touchend:function(){this.opacity=1},insertcheck:function(e){var t=this,s=u()(e),i=localStorage.getItem("yspatientinfo"),n=JSON.parse(i),a=n.name,r=this.form.examsubclass,o=n.openid,l=this,d=l.$store.getters.getUrl+"check/patientcheckup.do";return new c.a(function(e,i){var n=$.ajax({url:d,type:"post",dataType:"json",timeout:15e3,async:!0,data:{checkdata:s,visitdate:l.visitdate,username:a,items:r,openid:o,position:t.position},success:function(t){l.isshow=!1,"1"==t.status?(l.$Message.info("提交成功！"),e(),window.websocketobj.send(u()({cardno:l.form.cardno,massege:"123"}))):(l.modal1=!0,e())},error:function(e){l.isshow=!1,l.infomsg="请求发送失败",l.requestmodel=!0,i(e)},complete:function(e,t){"timeout"==t&&(n.abort(),l.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},tosubmit:function(){this.issubmit=!0},submit:function(){var e=this;return r()(n.a.mark(function t(){var s,i,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isshow=!0,0!=e.projectname.length){t.next=5;break}return e.isshow=!1,e.modal3=!0,t.abrupt("return");case 5:for(s=[],i=e.form,a=0;a<e.projectname.length;a++)i.descriptioncode=e.projectname[a].description_code,i.projectname=e.projectname[a].description,s.push({cardno:i.cardno,examsubclass:i.examsubclass,examclass:i.examclass,clindiag:i.clindiag,performedby:i.performedby,patientsource:"1",reqdatetime:i.reqdatetime,reqdept:i.reqdept,reqphysician:i.reqphysician,doctoruser:i.doctoruser,descriptioncode:i.descriptioncode,projectname:i.projectname,clinicno:i.clinicno,visitno:i.visitno});return t.next=10,e.insertcheck(s);case 10:e.init();case 11:case"end":return t.stop()}},t,e)}))()},deleteitem:function(e,t){for(var s=0;s<this.projectname.length;s++)this.projectname[s].description==e&&this.projectname.splice(t,1);this.dealprojectnamelist.splice(t,1)},changeproject:function(e){if(this.projectname=[],0!=e.length)for(var t=0;t<this.projectnamelist.length;t++)for(var s=0;s<e.length;s++)this.projectnamelist[t].description==e[s]&&this.projectname.push(this.projectnamelist[t])},changesubexamclass:function(e){var t=this;return r()(n.a.mark(function e(){var s,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t,t.form.examclass,t.form.examsubclass,e.next=5,s.fetchprojectnamelist(s.form.examclass,s.form.examsubclass);case 5:"1"==(i=e.sent).status?(s.isshowsubclass=!0,s.projectnamelist=i.data):5==i.status?(s.infomsg="请求发送失败",s.requestmodel=!0):(s.infomsg="数据获取失败",s.requestmodel=!0);case 7:case"end":return e.stop()}},e,t)}))()},topath:function(){this.$router.push("/registeredlist")},fetchprojectnamelist:function(e,t){this.dealprojectnamelist=[],this.projectname=[];var s=this;return s.isshow=!0,new c.a(function(i,n){var a=s.$store.getters.getUrl+"check/getcheckthreeclass.do";$.ajax({url:a,type:"post",dataType:"json",async:!1,data:{examclassname:e,examsubclassname:t},success:function(e){s.isshow=!1,i(e)},error:function(e){s.isshow=!1;i({status:5})}})})},dealsubcheklist:function(e){var t=this;this.subchecklist=e;for(var s=[],i=0;i<e.length;i++){var n={value:e[i].exam_subclass_name,label:e[i].exam_subclass_name};s.push(n)}return t.dealsubchecklist=[],new c.a(function(e,i){t.dealsubchecklist=s,t.form.examsubclass=t.dealsubchecklist[0].value,e()})},fetchSubchecklit:function(e){var t=this;return t.isshow=!0,new c.a(function(s,i){var n=t.$store.getters.getUrl+"check/getsubclass.do",a=$.ajax({url:n,type:"post",dataType:"json",timeout:15e3,async:!0,data:{classname:e},success:function(e){t.isshow=!0,s(e)},error:function(e){t.isshow=!0,i(e)},complete:function(e,s){"timeout"==s&&(a.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},fetchdepname:function(e){var t=this;return new c.a(function(s,i){var n=t.$store.getters.getUrl+"check/getdeptname.do";$.ajax({url:n,type:"post",dataType:"json",async:!1,data:{deptcode:e},success:function(e){s(e.data[0])},error:function(e){i(e)}})})},changeexamclass:function(e){var t=this;return r()(n.a.mark(function s(){var i,a,r,o,c;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.isshowsubclass=!1,e){s.next=3;break}return s.abrupt("return");case 3:for(i=t,a=0;a<t.checklist.length;a++)t.checklist[a].exam_class_name==e&&(t.form.performedby=t.checklist[a].perform_by);return s.next=7,i.fetchdepname(i.form.performedby);case 7:return r=s.sent,i.depname=r.dept_name,i.position=r.position,s.next=12,i.fetchSubchecklit(i.form.examclass);case 12:if(5!=(o=s.sent).status){s.next=17;break}return t.infomsg="请求发送失败",t.requestmodel=!0,s.abrupt("return");case 17:if("1"==o.status){s.next=21;break}return t.infomsg="数据请求失败",t.requestmodel=!0,s.abrupt("return");case 21:return s.next=23,i.dealsubcheklist(o.data);case 23:return s.next=25,i.fetchprojectnamelist(i.form.examclass,i.form.examsubclass);case 25:"1"==(c=s.sent).status?(i.isshowsubclass=!0,i.projectnamelist=c.data):5==c.status?(i.infomsg="请求发送失败",i.requestmodel=!0):(i.infomsg="数据获取失败",i.requestmodel=!0);case 27:case"end":return s.stop()}},s,t)}))()},dealcheckresult:function(e){this.dealchecklist=[];for(var t=[],s=0;s<e.length;s++){var i={value:e[s].exam_class_name,label:e[s].exam_class_name};t.push(i)}return t},fetchecklist:function(){var e=this;return new c.a(function(t,s){var i=e.$store.getters.getUrl+"check/getcheckclass.do",n=$.ajax({url:i,type:"post",dataType:"json",timeout:15e3,async:!0,data:"",success:function(e){t(e)},error:function(e){t({status:5})},complete:function(t,s){"timeout"==s&&(n.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},fetchclindiag:function(){var e=this,t=new Date,s=t.getFullYear(),i=t.getMonth()+1,n=t.getDate();i<10&&(i="0"+i),n<10&&(n="0"+n);var a=s+"-"+i+"-"+n;return new c.a(function(t,s){var i=e.$store.getters.getUrl+"check/getOutpMrDiagDesc.do";e.isshow=!0;var n=$.ajax({url:i,type:"post",dataType:"json",timeout:15e3,async:!0,data:{cardno:e.form.cardno,visitdate:a,doctorno:e.form.doctoruser},success:function(s){e.isshow=!1,t(s)},error:function(s){e.isshow=!1;t({status:5})},complete:function(t,s){"timeout"==s&&(n.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})})},init:function(){var e=this;return r()(n.a.mark(function t(){var s,i,a,r,o,c,l,u,d,m;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.visitdate="",e.depname="",e.form.cardno="",e.form.examsubclass="",e.form.examclass="",e.form.clindiag="",e.form.performedby="",e.form.patientsource="1",e.form.reqdatetime="",e.form.reqdept="",e.form.reqphysician="",e.form.doctoruser="",e.form.descriptioncode="",e.form.projectname="",e.form.clinicno="",e.form.visitno="",e.projectname=[],e.checklist=[],e.dealchecklist=[],e.subchecklist=[],e.dealsubchecklist=[],e.projectnamelist=[],e.dealprojectnamelist=[],s=localStorage.getItem("yspatientinfo"),i=JSON.parse(s),e.form.reqphysician=i.hosdocname,e.form.doctoruser=i.doctor,e.form.reqdept=i.registerdept,e.form.cardno=i.patientid,e.form.clinicno=i.clinicno,e.form.visitno=i.visitno,a=new Date,r=a.getFullYear(),o=a.getMonth()+1,c=a.getDate(),o<10&&(o="0"+o),c<10&&(c="0"+c),e.visitdate=r+"-"+o+"-"+c,e.form.reqdatetime=r+"-"+o+"-"+c,l=e,t.next=29,l.fetchclindiag();case 29:if("1"==(u=t.sent).status){t.next=34;break}return l.infomsg="获取数据失败",l.requestmodel=!0,t.abrupt("return");case 34:return l.form.clindiag=u.data[0].diagdesc,t.next=37,l.fetchecklist();case 37:if("1"==(d=t.sent).status){t.next=42;break}return l.infomsg="获取数据失败",l.requestmodel=!0,t.abrupt("return");case 42:l.checklist=d.data,m=l.dealcheckresult(d.data),l.dealchecklist=m,l.isshow=!1;case 46:case"end":return t.stop()}},t,e)}))()}},mounted:function(){var e=this;this.isshow=!0,setTimeout(function(){e.init()},10)}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"writecheck-page"},[s("div",{staticClass:"content"},[s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                临床诊断:\n            ")]),e._v(" "),s("Input",{staticClass:"input-item",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.clindiag,callback:function(t){e.$set(e.form,"clindiag",t)},expression:"form.clindiag"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                检查类别:\n            ")]),e._v(" "),s("Select",{on:{"on-change":e.changeexamclass},model:{value:e.form.examclass,callback:function(t){e.$set(e.form,"examclass",t)},expression:"form.examclass"}},e._l(e.dealchecklist,function(t,i){return s("Option",{key:i,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),e.isshowsubclass?s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                检查子类:\n            ")]),e._v(" "),s("Select",{attrs:{clearable:""},on:{"on-change":e.changesubexamclass},model:{value:e.form.examsubclass,callback:function(t){e.$set(e.form,"examsubclass",t)},expression:"form.examsubclass"}},e._l(e.dealsubchecklist,function(t,i){return s("Option",{key:i,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1):e._e(),e._v(" "),e.isshowsubclass?e._e():s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                检查子类:\n            ")]),e._v(" "),s("Select",{attrs:{clearable:""},model:{value:e.skyvalue,callback:function(t){e.skyvalue=t},expression:"skyvalue"}},e._l(e.testlist,function(t,i){return s("Option",{key:i,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                执行科室:\n            ")]),e._v(" "),s("Input",{staticClass:"input-item",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.depname,callback:function(t){e.depname=t},expression:"depname"}})],1),e._v(" "),s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"title-tip"},[e._v("\n                申请医生:\n            ")]),e._v(" "),s("Input",{staticClass:"input-item",attrs:{disabled:""},on:{"on-blur":function(t){return t.preventDefault(),e.inputLoseFocus(t)}},model:{value:e.form.reqphysician,callback:function(t){e.$set(e.form,"reqphysician",t)},expression:"form.reqphysician"}})],1),e._v(" "),e.form.examsubclass?s("div",{staticClass:"add-btn",on:{click:e.showmodel}},[e._v("\n            添加项目\n        ")]):e._e(),e._v(" "),e._l(e.projectname,function(t,i){return s("div",{key:i,staticClass:"input-wrapper"},[e._v("\n            "+e._s(t.description)),s("div",{on:{click:function(s){return e.deleteitem(t.description,i)}}},[e._v("删除")])])})],2),e._v(" "),s("div",[s("div",{staticClass:"primarybtn",style:{opacity:e.opacity},attrs:{long:""},on:{touchstart:e.touchstart,touchend:e.touchend,click:e.tosubmit}},[e._v("提交")])]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[e._v("\n        提交失败\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.modal3,callback:function(t){e.modal3=t},expression:"modal3"}},[e._v("\n        信息不全禁止提交\n    ")]),e._v(" "),s("Modal",{attrs:{title:"提示"},on:{"on-ok":e.submit},model:{value:e.issubmit,callback:function(t){e.issubmit=t},expression:"issubmit"}},[e._v("\n        请确认是否提交\n    ")]),e._v(" "),s("Modal",{attrs:{fullscreen:"",title:"检查项目"},model:{value:e.projectmodel,callback:function(t){e.projectmodel=t},expression:"projectmodel"}},[s("CheckboxGroup",{attrs:{size:"large"},on:{"on-change":e.changeproject},model:{value:e.dealprojectnamelist,callback:function(t){e.dealprojectnamelist=t},expression:"dealprojectnamelist"}},e._l(e.projectnamelist,function(e,t){return s("Checkbox",{key:t,staticClass:"Checkbox",attrs:{size:"large",label:e.description}})}),1)],1),e._v(" "),s("Modal",{attrs:{title:"提示"},model:{value:e.requestmodel,callback:function(t){e.requestmodel=t},expression:"requestmodel"}},[e._v("\n        "+e._s(e.infomsg)+"\n    ")]),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"isshow"}]})],1)},staticRenderFns:[]};var v=s("VU/8")(p,f,!1,function(e){s("MdCm")},"data-v-7c972881",null);t.default=v.exports}});