webpackJsonp([83],{"U+Ox":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("+n8h"),o=s("T4ej"),n=s("uGJ5"),i={name:"evaluate",components:{tabbar:a.a,loading:o.a},data:function(){return{single:!1,content:"",score:1,scores:1,deletion:"",flage:!1,txtVal:0,docName:"",depname:"",isshowloading:!1}},computed:{itemClasses:function(){for(var t=[],e=Math.floor(2*this.score)/2,s=e%1!=0,a=Math.floor(e),o=0;o<a;o++)t.push("on");for(s&&t.push("half");t.length<5;)t.push("off");return t},itemClassese:function(){for(var t=[],e=Math.floor(2*this.scores)/2,s=e%1!=0,a=Math.floor(e),o=0;o<a;o++)t.push("on");for(s&&t.push("half");t.length<5;)t.push("off");return t}},methods:{tobackdetail:function(){this.$router.push("/Myaccount")},stars:function(t){this.score=t+1},starss:function(t){this.scores=t+1},descInput:function(){this.txtVal=this.content.length},submitContent:function(){var t={},e=this,s=JSON.parse(localStorage.getItem("pingitems"));t.content=e.content,t.tdpj=e.score,t.zdpj=e.scores,t.deletion=e.deletion,t.openid=localStorage.getItem("openid"),t.patientid=localStorage.getItem("cardno"),t.doccode=e.$store.state.doccode,t.docname=e.docName,t.hosdeptname=s.hosdepname,t.sex=s.sex,t.clinicno=s.clinicno,t.birthdate=s.birthdate,t.idno=s.idno,t.amorpm=s.amorpm,t.cardname=s.cardname,t.name=s.name,t.regdate=s.regdate,t.regcode=s.regcode,t.registerfee=s.registerfee,t.age=s.age,t.visitno=s.visitno,t.hosdocname=s.hosdocname;var a=e.$store.getters.getUrl+"evaluate/insert.do";if(e.single?t.deletion=2:t.deletion=1,""!=t.content&&""!=t.tdpj&&""!=t.zdpj&&0!==t.content.replace(/\s+/g,"").length){e.isshowloading=!0;var o=$.ajax({url:a,type:"post",dataType:"json",timeout:15e3,data:t,success:function(t){e.isshowloading=!1,1==t.status?(e.$Message.success("评论成功"),e.$router.push("/Myaccount")):1==t.status&&e.$Message.success("评论失败")},error:function(t){e.isshowloading=!1,e.$Message.success("后台请求异常")},complete:function(t,s){"timeout"==s&&(o.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})}else""!=t.content&&""!=t.tdpj&&""!=t.zdpj&&0!=t.content.replace(/\s+/g,"").length||e.$Message.success("请填写评价内容，并评分")},attention:function(){var t=this,e=localStorage.getItem("openid"),s=t.$store.getters.getUrl+"follow/insert.do",a=t.$store.state.doccode,o=t.$store.state.CommentDoctornam,n=t.$store.state.ReviewDepartment,i=t.$store.state.name,c=localStorage.getItem("cardno");$.ajax({url:s,type:"post",dataType:"json",async:!1,data:{openid:e,doccode:a,hosdocname:o,hosdepname:n,name:i,cardno:c},success:function(e){t.isshowloading=!1,1==e.status?(t.$Message.success("关注成功"),t.flage=!0):t.$Message.error("关注失败")},error:function(e){t.isshowloading=!1}})},select:function(){localStorage.getItem("openid");var t=localStorage.getItem("cardno"),e=this.$store.getters.getUrl+"follow/attention.do",s=this,a=s.$store.state.doccode;$.ajax({url:e,type:"post",dataType:"json",async:!1,data:{cardno:t,doccode:a},success:function(t){1==t.status?s.flage=!0:(t.status=0)&&(s.flage=!1)},error:function(t){}})}},mounted:function(){this.select(),this.docName=this.$store.state.CommentDoctornam,this.depname=this.$store.state.ReviewDepartment;var t=this.$store.getters.getUrl+"SweepCode.do";Object(n.a)(t)}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{height:"100%",overflow:"auto"}},[s("div",{staticClass:"evaluate-page"},[s("div",{staticClass:"title"},[s("div",{staticClass:"arrow-icon1",on:{click:t.tobackdetail}},[s("Icon",{attrs:{size:"30",type:"ios-arrow-back"}})],1),t._v(" "),s("span",[t._v("评价医生")])]),t._v(" "),s("div",{staticClass:"nav"},[s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("div",{staticClass:"content_right"},[s("p",{staticStyle:{padding:"5px 10px"}},[t._v(t._s(t.docName))]),t._v(" "),s("p",[t._v(t._s(t.depname)+"主治医师")]),t._v(" "),s("p",[t._v("滦平县妇幼保健院")])])]),t._v(" "),s("div",{staticClass:"contenter"},[t.flage?s("button",[t._v("已关注")]):t._e(),t._v(" "),0==t.flage?s("button",{on:{click:function(e){return t.attention()}}},[t._v("关注")]):t._e()])]),t._v(" "),s("div",{staticClass:"ping"},[s("div",{staticClass:"comment"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{cols:"50",rows:"8",id:"textarea",placeholder:"请输入您的评价内容，不超过100个字",maxlength:"100"},domProps:{value:t.content},on:{input:[function(e){e.target.composing||(t.content=e.target.value)},t.descInput]}}),t._v(" "),s("p",{staticClass:"numberV",staticStyle:{"text-align":"right",width:"80%"}},[t._v(t._s(t.txtVal)+"/100")])])]),t._v(" "),s("div",{staticClass:"ping"},[s("div",{staticClass:"anonymity"},[s("p",[s("Checkbox",{attrs:{size:"large"},model:{value:t.single,callback:function(e){t.single=e},expression:"single"}},[t._v("匿名")])],1),t._v(" "),s("p",[t._v("您的评价可以帮助到其他小伙伴")])])]),t._v(" "),s("div",{staticClass:"footer"},[s("div",{staticClass:"footer_footer"},[t._m(1),t._v(" "),s("div",{staticClass:"footer_right"},[s("div",{staticClass:"div"},t._l(t.itemClasses,function(e,a){return s("li",{key:a,staticClass:"star-item",class:e,attrs:{"track-by":"index"},on:{click:function(e){return t.stars(a)}}})}),0),t._v(" "),s("div",{staticClass:"div"},t._l(t.itemClassese,function(e,a){return s("li",{key:a,staticClass:"star-item",class:e,attrs:{"track-by":"index"},on:{click:function(e){return t.starss(a)}}})}),0)])])]),t._v(" "),s("div",{staticClass:"bttn"},[s("button",{staticClass:"btn",on:{click:function(e){return t.submitContent()}}},[t._v("提交")])])]),t._v(" "),s("tabbar",{staticClass:"pubtabbar"}),t._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:t.isshowloading,expression:"isshowloading"}],staticClass:"loading"})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content_left"},[e("img",{attrs:{src:s("/1rS"),alt:"",width:"62"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"footer_left"},[e("p",[this._v("态度评价")]),this._v(" "),e("p",[this._v("诊断评价")])])}]};var r=s("VU/8")(i,c,!1,function(t){s("vTXb")},"data-v-0704c80c",null);e.default=r.exports},vTXb:function(t,e){}});