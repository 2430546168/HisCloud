webpackJsonp([10],{FgoD:function(t,e){},dzCT:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("mvHQ"),o=s.n(a),r=s("//Fk"),n=s.n(r),i=s("in0Q"),d=s("+n8h"),c=s("T4ej"),l=s("HywI"),u=s("uGJ5"),v=new Date;v.getFullYear();if(v.getMonth()+1<10)v.getMonth();else v.getMonth();if(v.getDate()<10)v.getDate();else v.getDate();var p={components:{personicon:i.a,tabbar:d.a,loading:c.a,pullRefresh:l.a},data:function(){return{isloading:!1,orderList:[],orderListes:[],fsorderListes:[],cityList:[],cardlist:[],model1:"",cardno:"",tradeno:"",modal10:!1,modal101:!1,isDisable:!1,currentIndex:"",miaomi:0,times:"",isDisabl:!1,isbinen:!0,value1:v,isDisables:!1}},methods:{refresh:function(){var t=this;return new n.a(function(e,s){setTimeout(function(){t.updated(),t.Tobeevaluated(),e()},2e3)})},tobackdetail:function(){this.$router.push("/Myaccount")},test:function(t){this.currentIndex=t,this.modal10=!0},tests:function(t){this.currentIndex=t,this.modal101=!0},getLocalTime:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1>9?e.getMonth()+1:"0"+(e.getMonth()+1))+"-"+(e.getDate()>9?e.getDate():"0"+e.getDate())},selecter:function(){this.updated(),this.Tobeevaluated()},updated:function(){var t=this,e=t.$store.getters.getUrl+"register/getRegisterRedis.do",s=localStorage.getItem("cardno");t.isloading=!0;var a=$.ajax({url:e,type:"post",timeout:15e3,data:{cardno:s},success:function(e){if(t.isloading=!1,e.length>0)for(var s=JSON.parse(e),a=0;a<s.length;a++)/\d{4}-\d{1,2}/g.exec(s[a].regdate)[0]==t.datatime(t.value1)?t.orderList.push(s[a]):t.orderList=[];else t.orderList=[]},error:function(e){t.$Loading.finish()},complete:function(e,s){"timeout"==s&&(a.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},datatime:function(t){var e=t,s=this.p(e.getFullYear()),a=this.p(e.getMonth()+1);this.p(e.getDate());return s+"-"+a},p:function(t){return t<10?"0"+t:t},Tobeevaluated:function(){var t=this,e=t.$store.getters.getUrl+"register/getRegisterInfo.do",s=localStorage.getItem("cardno"),a=t.datatime(t.value1);t.isloading=!0;var r=$.ajax({url:e,type:"post",timeout:15e3,data:{patientId:s,time:a},success:function(e){t.orderListes=[],t.isloading=!1;var s=JSON.parse(e);if(1==s.status){t.fsorderListes=s.data;for(var a=[],r=0;r<s.data.length;r++)a.push(s.data[r].visitno);if(a.length>0){var n=t.$store.getters.getUrl+"register/getTradenoVisitno.do";a=o()(a).replace(/\[|]/g,"");$.ajax({url:n,type:"post",timeout:15e3,data:{visitnoArr:a,type:"微信挂号"},success:function(e){if(1==JSON.parse(e).status){for(var s=t.fsorderListes,a=JSON.parse(e).data,o=[],r=0;r<s.length;r++)for(var n={},i=0;i<a.length;i++)s[r].visitno==a[i].visitno&&(n.name=s[r].name,n.age=s[r].age,n.amorpm=s[r].amorpm,n.birthdate=s[r].birthdate,n.cardname=s[r].cardname,n.cardno=s[r].cardno,n.clinicno=s[r].clinicno,n.doctorno=s[r].doctorno,n.hosdepcode=s[r].hosdepcode,n.hosdepname=s[r].hosdepname,n.hosdoccode=s[r].hosdoccode,n.hosdocname=s[r].hosdocname,n.idno=s[r].idno,n.operator=s[r].operator,n.pj=s[r].pj,n.regcode=s[r].regcode,n.regdate=s[r].regdate,n.registerfee=s[r].registerfee,n.sex=s[r].sex,n.status=s[r].status,n.visitno=s[r].visitno,n.tradeno=a[i].tradeno,o.push(n));t.orderListes=o}},error:function(t){}})}else t.orderListes=[]}else-1==s.status?(t.orderListes=[],t.$Message.warning(s.message)):t.orderListes=[]},error:function(e){t.isloading=!1},complete:function(e,s){"timeout"==s&&(r.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},refund:function(){var t=this,e=t.currentIndex;t.modal10=!1;var s={};s.cardno=t.orderListes[e].cardno,s.deptcode=t.orderListes[e].hosdepcode,s.visitdate=t.orderListes[e].regdate,s.tradeno=t.orderListes[e].tradeno,s.openid=t.orderListes[e].openid,s.name=t.orderListes[e].name,s.hosdepname=t.orderListes[e].hosdepname,s.docname=t.orderListes[e].hosdocname,s.amorpm=t.orderListes[e].amorpm,s.fee=t.orderListes[e].registerfee,s.visitno=t.orderListes[e].visitno;var a=t.$store.getters.getUrl+"register/registeredRefund.do";t.modal10=!1,t.isloading=!0;var o=$.ajax({url:a,type:"post",dataType:"json",timeout:15e3,data:s,success:function(e){t.isloading=!1,t.isDisable=!1,1==e.status?(t.$Message.success("您已成功取消订单"),t.Tobeevaluated()):0==e.status&&t.$Message.error("退款失败")},error:function(e){t.isDisable=!1,t.isloading=!1},complete:function(e,s){"timeout"==s&&(o.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},delateOrder:function(t){},topayment:function(){this.isDisable||(this.isDisable=!0,this.refund())},topayments:function(){this.isDisables||(this.isDisables=!0,this.delatea())},evaluate:function(t){if(void 0!=t&&null!=t&&""!=t){this.$store.commit("setDoctornam",t.hosdocname),this.$store.commit("setReview",t.hosdepname),this.$store.commit("setDoccode",t.hosdoccode);var e=o()(t);localStorage.setItem("pingitems",e),this.$store.commit("setName",t.name),this.$router.push("/evaluate")}},payment:function(t){var e=this;void 0!=t&&null!=t&&""!=t&&(localStorage.setItem("tradeno",t.tradeno),e.$store.commit("setRegprice",t.registerfee),e.$store.commit("setCardCode",t.cardno)),localStorage.setItem("body","微信挂号"),localStorage.setItem("time",t.starttime);var s=e.$store.getters.getUrl+"register/getVerification.do",a=e.$store.getters.getCardCode,o=t.hosdoccode,r=$.ajax({url:s,type:"post",dataType:"json",timeout:15e3,data:{cardno:a,doctorno:o},success:function(t){1==t.status?e.$router.push("/payment"):0==t.status?(e.updated(),e.btnTimer("支付超时，请重新挂号",0)):-1==t.status&&e.btnTimer("请求异常",0)},error:function(t){},complete:function(t,s){"timeout"==s&&(r.abort(),e.$Modal.warning({title:"友情提示",content:"请求超时"}))}})},btnTimer:function(t,e){var s=null,a=this;a.isDisabl=!0,1==a.isDisabl&&(0===e?a.$Message.warning(t):1==e?a.$Message.error(t):2==e&&a.$Message.success(t),s=setInterval(function(){a.isDisabl=!1,clearInterval(s)},1400))},delatea:function(){var t=this,e=t.currentIndex,s=t.$store.getters.getUrl+"register/cancelPay.do",a=t.orderList.data[e].cardno,o=t.orderList.data[e].tradeno,r=t.orderList.data[e].status;t.isloading=!0;var n=$.ajax({type:"post",url:s,dataType:"json",timeout:15e3,data:{cardno:a,tradeno:o,status:r},success:function(e){t.isloading=!1,t.isDisables=!1,t.modal101=!1,1==e.status&&(t.$Message.success("您已成功删除订单"),t.updated()),0==e.status&&t.$Message.error("删除订单失败"),-1==e.status&&t.$Message.error("删除异常")},error:function(e){t.isloading=!0,t.isDisables=!1},complete:function(e,s){"timeout"==s&&(n.abort(),t.$Modal.warning({title:"友情提示",content:"请求超时"}))}})}},created:function(){this.updated(),this.Tobeevaluated();var t=this.$store.getters.getUrl+"SweepCode.do";Object(u.a)(t)}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"orderLists"},[s("pull-refresh",{attrs:{next:t.refresh}},[s("div",{staticClass:"orderList-page",attrs:{slot:"list"},slot:"list"},[s("div",{staticClass:"tittle"},[s("div",{staticClass:"arrow-icon",on:{click:t.tobackdetail}},[s("Icon",{attrs:{size:"30",type:"ios-arrow-back"}})],1),t._v("挂号列表")]),t._v(" "),s("div",{staticClass:"xuanze",staticStyle:{position:"relative"}},[s("div",{staticStyle:{display:"inline-block",width:"100%"}},[s("span",{staticStyle:{color:"rgb(40, 184, 161)","font-size":"20px"}},[t._v("选择日期:")]),t._v(" "),s("el-date-picker",{staticStyle:{width:"35%",border:"0",position:"absolute",right:"5%",top:"7px"},attrs:{type:"month",placeholder:"选择月份",editable:!1,clearable:!1,size:"small"},on:{change:t.selecter},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1)]),t._v(" "),t.orderList.length<=0&&t.orderListes.length<=0?s("div",[s("p",{staticStyle:{"text-align":"center","font-size":"18px","margin-top":"30px"}},[t._v("您还未创建订单")])]):t._e(),t._v(" "),t._l(t.orderList,function(e,a){return s("div",{key:a,staticClass:"content"},[0!==t.orderList.length?s("div",{staticClass:"lineItem"},[s("p",[s("span",[t._v("滦平县妇幼保健院")]),t._v(" "),s("span",{staticClass:"green"},[t._v("待支付")]),t._v(" "),1==e.status?s("span",{staticClass:"green"},[t._v("待就诊")]):t._e(),t._v(" "),2==e.status?s("span",[t._v("待评价")]):t._e(),t._v(" "),3==e.status?s("span",[t._v("已评价")]):t._e(),t._v(" "),4==e.status?s("span",{staticStyle:{color:"red"}},[t._v("已退款")]):t._e()]),t._v(" "),s("p",[s("span",[t._v("订单号")]),t._v(" "),s("span",[t._v(t._s(e.tradeno))])]),t._v(" "),s("p",[s("span",[t._v("卡号")]),t._v(" "),s("span",[t._v(t._s(e.cardno))])]),t._v(" "),s("p",[s("span",[t._v("患者姓名")]),t._v(" "),s("span",[t._v(t._s(e.name))])]),t._v(" "),s("p",[s("span",[t._v("挂号时间")]),t._v(" "),s("span",[t._v(t._s(e.regdate))])]),t._v(" "),s("p",[s("span",[t._v("医生姓名")]),t._v(" "),s("span",[t._v(t._s(e.hosdocname))])]),t._v(" "),s("p",[s("span",[t._v("挂号费用")]),t._v(" "),s("span",{staticStyle:{color:"red"}},[t._v("￥"+t._s(e.registerfee))])]),t._v(" "),s("p",[s("span",[t._v("科室名称")]),t._v(" "),s("span",[t._v(t._s(e.hosdepname))])]),t._v(" "),s("p",[s("span",[t._v("挂号科目")]),t._v(" "),s("span",[t._v(t._s(e.regcode))])]),t._v(" "),s("p",[s("span"),t._v(" "),s("span",[s("Button",{attrs:{type:"success",disabled:t.isDisabl},on:{click:function(s){return s.stopPropagation(),t.payment(e)}}},[t._v("去支付")]),t._v(" "),2==e.status||0==e.pj?s("Button",{attrs:{type:"info"},on:{click:function(s){return s.stopPropagation(),t.evaluate(e)}}},[t._v("评价")]):t._e()],1)])]):t._e()])}),t._v(" "),t._l(t.orderListes,function(e,a){return s("div",{key:a,staticClass:"content"},[0!==t.orderListes.length?s("div",{staticClass:"lineItem"},[s("p",[s("span",[t._v("滦平县妇幼保健院")]),t._v(" "),1==e.status&&0==e.doctorno?s("span",{staticClass:"green"},[t._v("待就诊")]):t._e(),t._v(" "),2==e.status&&0==e.pj?s("span",[t._v("待评价")]):t._e(),t._v(" "),2==e.status&&1==e.pj?s("span",[t._v("已评价")]):t._e()]),t._v(" "),s("p"),t._v(" "),s("p",[s("span",[t._v("卡号")]),t._v(" "),s("span",[t._v(t._s(e.cardno))])]),t._v(" "),s("p",[s("span",[t._v("患者姓名")]),t._v(" "),s("span",[t._v(t._s(e.name))])]),t._v(" "),s("p",[s("span",[t._v("挂号时间")]),t._v(" "),s("span",[t._v(t._s(e.regdate))])]),t._v(" "),s("p",[s("span",[t._v("医生姓名")]),t._v(" "),s("span",[t._v(t._s(e.hosdocname))])]),t._v(" "),s("p",[s("span",[t._v("挂号费用")]),t._v(" "),s("span",{staticStyle:{color:"red"}},[t._v("￥"+t._s(e.registerfee))])]),t._v(" "),s("p",[s("span",[t._v("科室名称")]),t._v(" "),s("span",[t._v(t._s(e.hosdepname))])]),t._v(" "),s("p",[s("span",[t._v("挂号科目")]),t._v(" "),s("span",[t._v(t._s(e.regcode))])]),t._v(" "),s("p",[s("span"),t._v(" "),s("span",[2==e.status&&0==e.pj?s("Button",{attrs:{type:"info"},on:{click:function(s){return s.stopPropagation(),t.evaluate(e)}}},[t._v("评价")]):t._e(),t._v(" "),0==e.doctorno&&"wx"==e.operator?s("Button",{attrs:{type:"info"},on:{click:function(e){return e.stopPropagation(),t.test(a)}}},[t._v("取消挂号")]):t._e(),t._v(" "),s("Modal",{attrs:{width:"360"},model:{value:t.modal10,callback:function(e){t.modal10=e},expression:"modal10"}},[s("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),s("span",[t._v("取消挂号")])],1),t._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("p",[t._v("您确认要取消挂号吗")])]),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"success",size:"large",long:""},on:{click:function(e){return t.topayment()}}},[t._v("确定")])],1)])],1)])]):t._e()])})],2)]),t._v(" "),s("tabbar",{staticClass:"pubtabbar"}),t._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:t.isloading,expression:"isloading"}]})],1)},staticRenderFns:[]};var g=s("VU/8")(p,_,!1,function(t){s("gdBO")},"data-v-d52ecca2",null);e.default=g.exports},gdBO:function(t,e){},in0Q:function(t,e,s){"use strict";var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pubavatar"},[e("img",{attrs:{src:s("HfaK"),width:"35"}})])}]};var o=s("VU/8")({data:function(){return{}}},a,!1,function(t){s("FgoD")},"data-v-f6aaf10c",null);e.a=o.exports}});